<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <meta name="author" content="Manuel Montenegro Montes">
  <title>Inmutabilidad y tipos algebraicos de datos en Java</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="dist/reset.css">
  <link rel="stylesheet" href="dist/reveal.css">
  <link rel="stylesheet" href="css/nnfx-light.min.css">
  <style>
    .reveal .sourceCode {  /* see #7635 */
      overflow: visible;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    /* The extra [class] is a hack that increases specificity enough to
       override a similar rule in reveal.js */
    ul.task-list[class]{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      font-size: inherit;
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {  background-color: #f8f8f8; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ef2929; } /* Alert */
    code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #204a87; } /* Attribute */
    code span.bn { color: #0000cf; } /* BaseN */
    code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4e9a06; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #8f5902; font-style: italic; } /* Comment */
    code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
    code span.dt { color: #204a87; } /* DataType */
    code span.dv { color: #0000cf; } /* DecVal */
    code span.er { color: #a40000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #0000cf; } /* Float */
    code span.fu { color: #204a87; font-weight: bold; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
    code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
    code span.ot { color: #8f5902; } /* Other */
    code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
    code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
    code span.ss { color: #4e9a06; } /* SpecialString */
    code span.st { color: #4e9a06; } /* String */
    code span.va { color: #000000; } /* Variable */
    code span.vs { color: #4e9a06; } /* VerbatimString */
    code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="css/pdap.css" id="theme">
</head>
<body>
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="img/RedBackground.jpg">
  <h1 class="title">Inmutabilidad y tipos algebraicos de datos en
Java</h1>
<div id="author-container">
<div class="author">
Manuel Montenegro Montes
<br>
<span id="email"><a href="montenegro@fdi.ucm.es">montenegro@fdi.ucm.es</a></span>
</div>
<div class="subject">
<strong>Programación Declarativa Aplicada</strong>
<br>Máster en Ingeniería Informática<br>Facultad de
Informática<br>Universidad Complutense de Madrid
</div>
</div>
</section>

<section id="section" class="slide level2 outline"
data-background-image="img/RedBackground.jpg">
<h2 class="outline" data-background-image="img/RedBackground.jpg"></h2>
<ol type="1">
<li>Inmutabilidad mediante <span
style="font-family: monospace;text-transform: none;">final</span></li>
<li>Tipos producto mediante <span
style="font-family: monospace;text-transform: none;">record</span></li>
<li>Tipos unión</li>
<li>Gestión de errores mediante <span
style="font-family: monospace;text-transform: none;">Optional&lt;T&gt;</span></li>
<li>Estructuras de datos persistentes</li>
</ol>
</section>
<section>
<section id="inmutabilidad-mediante-final"
class="title-slide slide level1">
<h1>Inmutabilidad mediante <code>final</code></h1>

</section>
<section id="palabra-clave-final" class="slide level2">
<h2>Palabra clave <code>final</code></h2>
<ul>
<li><p>Una manera de forzar la inmutabilidad en Java es declarando las
variables como <code>final</code>.</p></li>
<li><p>Las variables <code>final</code>, una vez inicializadas, no
pueden ser modificadas.</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dt">final</span> <span class="dt">int</span> y <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="dv">4</span><span class="op">;</span>  <span class="arrow_box_left fragment"> Error: variable no modificable </span></span></code></pre></div>

</section>
<section class="slide level2">

<ul>
<li><p>Las variables <code>final</code> pueden inicializarse después de
su definición.</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dt">final</span> <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>args<span class="op">.</span><span class="fu">length</span> <span class="op">&gt;</span> <span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

<div class="fragment">
<p>El ejemplo anterior podría haberse expresado del siguiente modo:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="dt">final</span> <span class="dt">int</span> x <span class="op">=</span> args<span class="op">.</span><span class="fu">length</span> <span class="op">&gt;</span> <span class="dv">1</span> <span class="op">?</span> <span class="dv">3</span> <span class="op">:</span> <span class="dv">5</span><span class="op">;</span></span></code></pre></div>

</div></li>
</ul>
</section>
<section id="atributos-final-en-clases" class="slide level2">
<h2>Atributos <code>final</code> en clases</h2>
<ul>
<li>Es posible declarar atributos <code>final</code> dentro de las
clases. Pueden ser ser inicializados en la declaración, o en el
constructor.</li>
</ul>
<div class="sourceCode" id="cb4"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> Punto <span class="op">{</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">private</span> <span class="dt">final</span> <span class="dt">int</span> x<span class="op">;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">private</span> <span class="dt">final</span> <span class="dt">int</span> y<span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> <span class="fu">Punto</span><span class="op">(</span><span class="dt">int</span> x<span class="op">,</span> <span class="dt">int</span> y<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="fu">x</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="fu">y</span> <span class="op">=</span> y<span class="op">;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> <span class="fu">setX</span><span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">.</span><span class="fu">x</span> <span class="op">=</span> x<span class="op">;</span>  <span class="arrow_box_left fragment"> Error: reasignando variable final </span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">//...</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

</section>
<section id="inconvenientes-de-final" class="slide level2">
<h2>Inconvenientes de <code>final</code></h2>
<ul>
<li><p>El modificador <code>final</code> prohibe cambiar el valor de la
variable, pero no prohibe mutar el objeto apuntado por esa variable.</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="dt">final</span> <span class="dt">int</span><span class="op">[]</span> arr <span class="op">=</span> <span class="kw">new</span> <span class="dt">int</span><span class="op">[]</span> <span class="op">{</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">23</span> <span class="op">};</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> <span class="kw">new</span> <span class="dt">int</span><span class="op">[]</span> <span class="op">{</span> <span class="dv">10</span><span class="op">,</span> <span class="dv">20</span><span class="op">,</span> <span class="dv">30</span> <span class="op">};</span>   <span class="arrow_box_left fragment"> Incorrecto: no se puede cambiar `arr` </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>arr<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span>     <span class="arrow_box_left fragment"> ...pero sí se puede cambiar el array apuntado por `arr` </span></span></code></pre></div>

<div class="sourceCode" id="cb6"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="dt">final</span> <span class="dt">var</span> ls <span class="op">=</span> <span class="kw">new</span> <span class="bu">ArrayList</span><span class="op">&lt;</span><span class="bu">Integer</span><span class="op">&gt;();</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>ls<span class="op">.</span><span class="fu">add</span><span class="op">(</span><span class="dv">10</span><span class="op">);</span>                        <span class="arrow_box_left fragment"> Correcto </span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>ls<span class="op">.</span><span class="fu">add</span><span class="op">(</span><span class="dv">20</span><span class="op">);</span>                        <span class="arrow_box_left fragment"> Correcto </span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>ls <span class="op">=</span> <span class="bu">Arrays</span><span class="op">.</span><span class="fu">asList</span><span class="op">(-</span><span class="dv">4</span><span class="op">,</span> <span class="dv">1</span><span class="op">,</span> <span class="dv">4</span><span class="op">,</span> <span class="dv">7</span><span class="op">);</span>   <span class="arrow_box_left fragment"> Incorrecto </span></span></code></pre></div>
</li>
</ul>
</section>
<section class="slide level2">

<ul>
<li><p>Para poder disponer de inmutabilidad completa, hemos de asegurar
que los tipos de los atributos y las variables sean inmutables.</p></li>
<li><p>En particular:</p>
<ul>
<li><p>Los objetos <code>String</code> son inmutables.</p></li>
<li><p>Las listas devueltas por <code>List.of(...)</code> o por
<code>Arrays.asList(...)</code> son inmutables.</p></li>
<li><p>Los diccionarios devueltos por <code>Map.of(...)</code> son
inmutables.</p></li>
</ul></li>
<li><p>Mediante librerías externas, podemos tener colecciones de datos
inmutables.</p></li>
</ul>
</section></section>
<section>
<section id="tipos-producto-mediante-record"
class="title-slide slide level1">
<h1>Tipos producto mediante <code>record</code></h1>

</section>
<section id="tipos-producto" class="slide level2">
<h2>Tipos producto</h2>
<ul>
<li><p>En programación orientada a objetos, es posible representar un
tipo producto mediante una <strong>clase</strong>.</p></li>
<li><p>Tradicionalmente, en POO las clases no solo sirven para almacenar
datos, sino también para implementar <strong>operaciones</strong> que
mutan esos datos.</p></li>
<li><p>Sin embargo, en programación funcional, los tipos de datos se
definen de manera separada de las operaciones.</p></li>
</ul>
</section>
<section id="tipos-producto-mediante-clases" class="slide level2">
<h2>Tipos producto mediante clases</h2>
<div class="sourceCode" id="cb7"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">class</span> Fecha <span class="op">{</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Atributos</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">private</span> <span class="dt">final</span> <span class="dt">int</span> dia<span class="op">;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">private</span> <span class="dt">final</span> <span class="dt">int</span> mes<span class="op">;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">private</span> <span class="dt">final</span> <span class="dt">int</span> anyo<span class="op">;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Constructor</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> <span class="fu">Fecha</span><span class="op">(</span><span class="dt">int</span> dia<span class="op">,</span> <span class="dt">int</span> mes<span class="op">,</span> <span class="dt">int</span> anyo<span class="op">)</span> <span class="op">{</span> <span class="co">/* ... */</span> <span class="op">}</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Métodos de acceso</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> <span class="dt">int</span> <span class="fu">getDia</span><span class="op">()</span> <span class="op">{</span> <span class="co">/* ... */</span> <span class="op">}</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> <span class="dt">int</span> <span class="fu">getMes</span><span class="op">()</span> <span class="op">{</span> <span class="co">/* ... */</span> <span class="op">}</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> <span class="dt">int</span> <span class="fu">getAnyo</span><span class="op">()</span> <span class="op">{</span> <span class="co">/* ... */</span> <span class="op">}</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

<p><span class="rojo fragment"><em>¡Cuánto código para un tipo tan
simple!</em></span></p>
</section>
<section id="tipos-producto-mediante-records" class="slide level2">
<h2>Tipos producto mediante <em>records</em></h2>
<div class="sourceCode" id="cb8"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">record</span> <span class="fu">Fecha</span><span class="op">(</span><span class="dt">int</span> dia<span class="op">,</span> <span class="dt">int</span> mes<span class="op">,</span> <span class="dt">int</span> anyo<span class="op">)</span> <span class="op">{</span> <span class="op">}</span></span></code></pre></div>

<div>
<ul>
<li class="fragment"><p>Define una clase <code>Fecha</code> con tres
atributos.</p>
<ul>
<li class="fragment">Los atributos son <code>final</code>, aunque no se
indique explícitamente.</li>
</ul></li>
<li class="fragment"><p>Dentro de la declaración de un
<code>record</code> (entre <code>{</code> y <code>}</code>):</p>
<ul>
<li class="fragment"><p>Se pueden definir métodos.</p></li>
<li class="fragment"><p>No se pueden definir nuevos atributos.</p></li>
</ul></li>
<li class="fragment"><p>Un <code>record</code> puede implementar
interfaces, pero no extender clases.</p></li>
</ul>
</div>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb9"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">record</span> <span class="fu">Fecha</span><span class="op">(</span><span class="dt">int</span> dia<span class="op">,</span> <span class="dt">int</span> mes<span class="op">,</span> <span class="dt">int</span> anyo<span class="op">)</span> <span class="op">{</span> <span class="op">}</span></span></code></pre></div>

<ul>
<li><p>En un <code>record</code> se generan automáticamente:</p>
<ul>
<li>Un constructor <code>Fecha(int dia, int mes, int anyo)</code></li>
<li>Métodos de acceso: <code>dia()</code>, <code>mes()</code>,
<code>anyo()</code></li>
<li>Método <code>toString()</code></li>
<li>Método <code>equals()</code></li>
<li>Método <code>hashCode()</code></li>
</ul></li>
</ul>
</section>
<section class="slide level2">

<h3 id="ejemplo-de-uso">Ejemplo de uso</h3>
<div class="sourceCode" id="cb10"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> f1 <span class="op">=</span> <span class="kw">new</span> <span class="fu">Fecha</span><span class="op">(</span><span class="dv">15</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">1979</span><span class="op">);</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> f2 <span class="op">=</span> <span class="kw">new</span> <span class="fu">Fecha</span><span class="op">(</span><span class="dv">15</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">1979</span><span class="op">);</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>f1<span class="op">);</span>   <span class="arrow_box_left fragment"> Uso de `toString()` </span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Imprime: Fecha[dia=15, mes=3, anyo=1979]</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="op">(</span>f1<span class="op">.</span><span class="fu">equals</span><span class="op">(</span>f2<span class="op">))</span> <span class="op">{</span>      <span class="arrow_box_left fragment"> Uso de `equals()` </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span><span class="st">&quot;Las fechas son iguales&quot;</span><span class="op">);</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> dias <span class="op">=</span> Stream<span class="op">.</span><span class="fu">of</span><span class="op">(</span>f1<span class="op">,</span> f2<span class="op">)</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>              <span class="op">.</span><span class="fu">map</span><span class="op">(</span>Fecha<span class="op">::</span>dia<span class="op">)</span>    <span class="arrow_box_left fragment"> Uso de método `dia()` </span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>              <span class="op">.</span><span class="fu">toList</span><span class="op">();</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>dias<span class="op">);</span> <span class="co">// Imprime: [15, 15]</span></span></code></pre></div>

</section>
<section class="slide level2">

<ul>
<li>Los métodos generados automáticamente se pueden sobreescribir:</li>
</ul>
<div class="sourceCode" id="cb11"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">record</span> <span class="fu">Fecha</span><span class="op">(</span><span class="dt">int</span> dia<span class="op">,</span> <span class="dt">int</span> mes<span class="op">,</span> <span class="dt">int</span> anyo<span class="op">)</span> <span class="op">{</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">@Override</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> <span class="bu">String</span> <span class="hl">toString</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">String</span><span class="op">.</span><span class="fu">format</span><span class="op">(</span><span class="st">&quot;</span><span class="sc">%02d</span><span class="st">/</span><span class="sc">%02d</span><span class="st">/</span><span class="sc">%04d</span><span class="st">&quot;</span><span class="op">,</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                          <span class="kw">this</span><span class="op">.</span><span class="fu">dia</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="fu">mes</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="fu">anyo</span><span class="op">);</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span>  </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

</section>
<section class="slide level2">

<ul>
<li>Se puede modificar el constructor canónico, o añadir constructores
extra:</li>
</ul>
<div class="sourceCode" id="cb12"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">record</span> <span class="fu">Fecha</span><span class="op">(</span><span class="dt">int</span> dia<span class="op">,</span> <span class="dt">int</span> mes<span class="op">,</span> <span class="dt">int</span> anyo<span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Si modificamos el constructor canónico, no hace falta definir los</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">// parámetros. Tampoco hace falta asignar los atributos `dia`, `mes` y</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">// `anyo`, a menos que queramos modificarlos.</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> Fecha <span class="op">{</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">(</span>mes <span class="op">&lt;</span> <span class="dv">1</span> <span class="op">||</span> mes <span class="op">&gt;</span> <span class="dv">12</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>      <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">RuntimeException</span><span class="op">(</span><span class="st">&quot;Mes no válido: &quot;</span> <span class="op">+</span> mes<span class="op">);</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Constructor alternativo: delega en el constructor canónico</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> <span class="fu">Fecha</span><span class="op">(</span><span class="dt">int</span> anyo<span class="op">)</span> <span class="op">{</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">this</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> anyo<span class="op">);</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

</section>
<section id="operaciones-modificadoras" class="slide level2">
<h2>Operaciones modificadoras</h2>
<div>
<ul>
<li class="fragment"><p>Como los atributos de un <em>record</em> son
<code>final</code>, no se generan <em>setters</em>.</p></li>
<li class="fragment"><p>No obstante, podemos añadir métodos
<code>with</code> para generar copias de objetos, modificando algún
atributo:</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">record</span> <span class="fu">Fecha</span><span class="op">(</span><span class="dt">int</span> dia<span class="op">,</span> <span class="dt">int</span> mes<span class="op">,</span> <span class="dt">int</span> anyo<span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> Fecha <span class="fu">withDia</span><span class="op">(</span><span class="dt">int</span> dia<span class="op">)</span> <span class="op">{</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="kw">new</span> <span class="fu">Fecha</span><span class="op">(</span>dia<span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="fu">mes</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="fu">anyo</span><span class="op">);</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

<div class="sourceCode" id="cb14"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> f1 <span class="op">=</span> <span class="kw">new</span> <span class="fu">Fecha</span><span class="op">(</span><span class="dv">15</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">1979</span><span class="op">);</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> f3 <span class="op">=</span> f1<span class="op">.</span><span class="fu">withDia</span><span class="op">(</span>f1<span class="op">.</span><span class="fu">dia</span><span class="op">()</span> <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>f3<span class="op">);</span> <span class="co">// 16/03/1979</span></span></code></pre></div>
</li>
</ul>
</div>
</section>
<section id="biblioteca-immutables" class="slide level2 ext"
data-background-image="img/Extension.jpg">
<h2 class="ext" data-background-image="img/Extension.jpg">Biblioteca
<em>Immutables</em></h2>
<p><a
href="https://immutables.github.io/">https://immutables.github.io/</a></p>
<ul>
<li><p>Biblioteca para la creación de clases que representan objetos
inmutables.</p></li>
<li><p>Utiliza los <em>procesadores de anotaciones</em> de Java para
generar automáticamente código.</p></li>
</ul>
</section>
<section id="section-1" class="slide level2 ext"
data-background-image="img/Extension.jpg">
<h2 class="ext" data-background-image="img/Extension.jpg"></h2>
<h3 id="ejemplo-de-definición">Ejemplo de definición</h3>
<ul>
<li><p>Definimos tipo unión <code>Fecha</code> con tres atributos:</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">org</span><span class="op">.</span><span class="im">immutables</span><span class="op">.</span><span class="im">value</span><span class="op">.</span><span class="im">Value</span><span class="op">;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="at">@Value</span><span class="op">.</span><span class="fu">Immutable</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">abstract</span> <span class="kw">class</span> Fecha <span class="op">{</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> <span class="kw">abstract</span> <span class="dt">int</span> <span class="fu">dia</span><span class="op">();</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> <span class="kw">abstract</span> <span class="dt">int</span> <span class="fu">mes</span><span class="op">();</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> <span class="kw">abstract</span> <span class="dt">int</span> <span class="fu">anyo</span><span class="op">();</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</li>
<li><p>La anotación <code>@Value.Immutable</code> es procesada en tiempo
de compilación para generar clases y métodos auxiliares.</p></li>
</ul>
</section>
<section id="section-2" class="slide level2 ext"
data-background-image="img/Extension.jpg">
<h2 class="ext" data-background-image="img/Extension.jpg"></h2>
<h3 id="ejemplos-de-uso">Ejemplos de uso</h3>
<ul>
<li><p>Por defecto, la creación de objetos con anotados con
<code>@Value.Immutable</code> utiliza el patrón <em>builder</em>:</p>
<div class="sourceCode" id="cb16"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>Fecha f1 <span class="op">=</span> ImmutableFecha<span class="op">.</span><span class="fu">builder</span><span class="op">()</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">dia</span><span class="op">(</span><span class="dv">10</span><span class="op">)</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">mes</span><span class="op">(</span><span class="dv">3</span><span class="op">)</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">anyo</span><span class="op">(</span><span class="dv">1983</span><span class="op">)</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">build</span><span class="op">();</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>f1<span class="op">);</span>   <span class="co">// Fecha{dia=10, mes=3, anyo=1983}</span></span></code></pre></div>
</li>
<li><p>También se pueden crear copias modificadas de objetos a partir de
ya existentes:</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>Fecha f2  <span class="op">=</span> ImmutableFecha<span class="op">.</span><span class="fu">copyOf</span><span class="op">(</span>f1<span class="op">).</span><span class="fu">withAnyo</span><span class="op">(</span><span class="dv">1984</span><span class="op">);</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>f1<span class="op">);</span>   <span class="co">// Fecha{dia=10, mes=3, anyo=1984}  </span></span></code></pre></div>
</li>
</ul>
</section>
<section id="section-3" class="slide level2 ext"
data-background-image="img/Extension.jpg">
<h2 class="ext" data-background-image="img/Extension.jpg"></h2>
<ul>
<li><p>Es posible configurar la interfaz de las clases generadas
automáticamente:</p>
<div class="sourceCode" id="cb18"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="kw">import</span> <span class="im">org</span><span class="op">.</span><span class="im">immutables</span><span class="op">.</span><span class="im">value</span><span class="op">.</span><span class="im">Value</span><span class="op">;</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="at">@Value</span><span class="op">.</span><span class="fu">Immutable</span><span class="op">(</span>builder <span class="op">=</span> <span class="kw">false</span><span class="op">,</span>   <span class="arrow_box_left"> No generar builders </span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>                 copy <span class="op">=</span> <span class="kw">false</span><span class="op">)</span>      <span class="arrow_box_left"> No generar métodos de copia </span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">abstract</span> <span class="kw">class</span> Fecha <span class="op">{</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">@Value</span><span class="op">.</span><span class="fu">Parameter</span> <span class="kw">public</span> <span class="kw">abstract</span> <span class="dt">int</span> <span class="fu">dia</span><span class="op">();</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">@Value</span><span class="op">.</span><span class="fu">Parameter</span> <span class="kw">public</span> <span class="kw">abstract</span> <span class="dt">int</span> <span class="fu">mes</span><span class="op">();</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">@Value</span><span class="op">.</span><span class="fu">Parameter</span> <span class="kw">public</span> <span class="kw">abstract</span> <span class="dt">int</span> <span class="fu">anyo</span><span class="op">();</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

<div class="sourceCode" id="cb19"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Cuando se deshabilitan los builders, se crean las instancias mediante</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">// el método `of`</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>Fecha f3 <span class="op">=</span> ImmutableFecha<span class="op">.</span><span class="fu">of</span><span class="op">(</span><span class="dv">15</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">1979</span><span class="op">);</span></span></code></pre></div>
</li>
</ul>
</section></section>
<section>
<section id="tipos-unión" class="title-slide slide level1">
<h1>Tipos unión</h1>

</section>
<section id="tipos-unión-1" class="slide level2">
<h2>Tipos unión</h2>
<ul>
<li><p>En lenguajes orientados a objetos, se puede modelizar un tipo
unión utilizando <strong>herencia</strong>:</p>
<ul>
<li>Una interfaz abstracta para el tipo unión.</li>
<li>Clases concretas para cada alternativa.</li>
</ul></li>
</ul>
<p><img data-src="17/Figura.svg" /></p>
</section>
<section id="enfoque-tradicional-poo" class="slide level2">
<h2>Enfoque tradicional (POO)</h2>
<ul>
<li>En POO, la manera idiomática de añadir operaciones a un tipo unión
es incorporarlas como <strong>métodos abstractos</strong>:</li>
</ul>
<p><img data-src="17/FiguraMetodos.svg" /></p>
</section>
<section class="slide level2">

<h3 id="interfaz-figura">Interfaz <code>Figura</code></h3>
<div class="sourceCode" id="cb20"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">interface</span> Figura <span class="op">{</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">double</span> <span class="fu">area</span><span class="op">();</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

<div class="fragment">
<h3 id="tipo-rectangulo">Tipo <code>Rectangulo</code></h3>
<div class="sourceCode" id="cb21"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">record</span> <span class="fu">Rectangulo</span><span class="op">(</span>Punto centro<span class="op">,</span> <span class="dt">double</span> ancho<span class="op">,</span> <span class="dt">double</span> alto<span class="op">)</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                                                  <span class="kw">implements</span> Figura <span class="op">{</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">@Override</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> <span class="dt">double</span> <span class="fu">area</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ancho <span class="op">*</span> alto<span class="op">;</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

</div>
</section>
<section class="slide level2">

<h3 id="tipo-circulo">Tipo <code>Circulo</code></h3>
<div class="sourceCode" id="cb22"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">record</span> <span class="fu">Circulo</span><span class="op">(</span>Punto centro<span class="op">,</span> <span class="dt">double</span> radio<span class="op">)</span> <span class="kw">implements</span> Figura <span class="op">{</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">@Override</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> <span class="dt">double</span> <span class="fu">area</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">PI</span> <span class="op">*</span> radio <span class="op">*</span> radio<span class="op">;</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

<div class="fragment">
<h3 id="tipo-segmento">Tipo <code>Segmento</code></h3>
<div class="sourceCode" id="cb23"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">record</span> <span class="fu">Segmento</span><span class="op">(</span>Punto origen<span class="op">,</span> Punto destino<span class="op">)</span> <span class="kw">implements</span> Figura <span class="op">{</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">@Override</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> <span class="dt">double</span> <span class="fu">area</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

</div>
</section>
<section id="ventajas-e-inconvenientes-del-enfoque-poo"
class="slide level2">
<h2>Ventajas e inconvenientes del enfoque POO</h2>
<ul style="list-style:none;padding:0;margin:0">
<li class="hands_down fragment">
Las definiciones de una misma función están dispersas entre varias
clases.
</li>
<li class="hands_down fragment">
Si la jerarquía de clases está en una biblioteca aparte, no es posible
añadir nuevas operaciones al tipo unión.
</li>
<li class="hands_up fragment" style="margin-top:3em">
<strong>Extensibilidad vertical</strong>: es fácil añadir nuevas
alternativas al tipo unión.
</li>
</ul>
</section>
<section id="enfoque-funcional" class="slide level2">
<h2>Enfoque funcional</h2>
<div>
<ul>
<li class="fragment"><p>Consiste en implementar las operaciones de un
tipo unión fuera de la jerarquía, y <strong>distinguir casos</strong>
según la alternativa del tipo unión.</p></li>
<li class="fragment"><p>Es decir, hacer algo similar a lo que hacíamos
en Elixir:</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode elixir"><code class="sourceCode elixir"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> area<span class="fu">(</span>%<span class="cn">Rectangulo</span><span class="fu">{}</span> <span class="op">=</span> r<span class="fu">)</span>, <span class="va">do:</span> r<span class="op">.</span>alto <span class="op">*</span> r<span class="op">.</span>ancho</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> area<span class="fu">(</span>%<span class="cn">Circulo</span><span class="fu">{}</span> <span class="op">=</span> c<span class="fu">)</span>, <span class="va">do:</span> <span class="va">:math</span><span class="op">.</span>pi<span class="fu">()</span> <span class="op">*</span> c<span class="op">.</span>radio <span class="op">*</span> c<span class="op">.</span>radio</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> area<span class="fu">(</span>%<span class="cn">Segmento</span><span class="fu">{})</span>, <span class="va">do:</span> <span class="dv">0</span>  </span></code></pre></div>
</li>
</ul>
</div>
</section>
<section class="slide level2">

<ul>
<li><p>La implementación en Java queda del siguiente modo:</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">double</span> <span class="fu">area</span><span class="op">(</span>Figura f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>f <span class="kw">instanceof</span> Rectangulo<span class="op">)</span> <span class="op">{</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    Rectangulo r <span class="op">=</span> <span class="op">(</span>Rectangulo<span class="op">)</span> f<span class="op">;</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r<span class="op">.</span><span class="fu">alto</span><span class="op">()</span> <span class="op">*</span> r<span class="op">.</span><span class="fu">ancho</span><span class="op">();</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>f <span class="kw">instanceof</span> Circulo<span class="op">)</span> <span class="op">{</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    Circulo c <span class="op">=</span> <span class="op">(</span>Circulo<span class="op">)</span> f<span class="op">;</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">PI</span> <span class="op">*</span> c<span class="op">.</span><span class="fu">radio</span><span class="op">()</span> <span class="op">*</span> c<span class="op">.</span><span class="fu">radio</span><span class="op">();</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span>  <span class="co">// Segmento</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</li>
</ul>
<ul style="list-style:none;padding:0;margin:0">
<li class="hands_down fragment">
Es necesario hacer un <em>casting</em> en cada una de las alternativas.
</li>
<li class="hands_down fragment">
Cadena <code>if</code>–<code>else if</code>–<code>else if</code>.
</li>
</ul>
</section>
<section id="instanceof-con-ajuste-de-patrones-java-18"
class="slide level2">
<h2><code>instanceof</code> con ajuste de patrones (Java 18)</h2>
<ul>
<li><p>Es posible realizar la comprobación de tipos y declarar una
variable del tipo correspondiente en un único paso:</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">double</span> <span class="fu">area</span><span class="op">(</span>Figura f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>f <span class="kw">instanceof</span> Rectangulo <span class="hl">r</span><span class="op">)</span> <span class="op">{</span>   <span class="arrow_box_left fragment"> `r` es de tipo `Rectangulo` </span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r<span class="op">.</span><span class="fu">alto</span><span class="op">()</span> <span class="op">*</span> r<span class="op">.</span><span class="fu">ancho</span><span class="op">();</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span> <span class="cf">else</span> <span class="cf">if</span> <span class="op">(</span>f <span class="kw">instanceof</span> Circulo <span class="hl">c</span><span class="op">)</span> <span class="op">{</span>  <span class="arrow_box_left fragment"> `c` es de tipo `Circulo` </span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">PI</span> <span class="op">*</span> c<span class="op">.</span><span class="fu">radio</span><span class="op">()</span> <span class="op">*</span> c<span class="op">.</span><span class="fu">radio</span><span class="op">();</span>   </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span>  <span class="co">// Segmento</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</li>
</ul>
<div class="fragment">
<ul>
<li>Los ámbitos de las variables <code>r</code> y <code>c</code> son los
de las ramas del <code>if</code> correspondientes.</li>
</ul>
</div>
</section>
<section id="expresiones-switch-java-17" class="slide level2">
<h2>Expresiones <code>switch</code> (Java 17)</h2>
<ul>
<li>La construcción <code>switch</code> ha existido en Java desde los
inicios del lenguaje, pero no como expresión, sino como sentencia:</li>
</ul>
<div class="sourceCode" id="cb27"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> diaSemana <span class="op">=</span> <span class="kw">...</span><span class="op">;</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="bu">String</span> diaStr <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="cf">switch</span><span class="op">(</span>diaSemana<span class="op">)</span> <span class="op">{</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">case</span> <span class="dv">0</span><span class="op">:</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    diaStr <span class="op">=</span> <span class="st">&quot;LUNES&quot;</span><span class="op">;</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span><span class="op">;</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">case</span> <span class="dv">1</span><span class="op">:</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    diaStr <span class="op">=</span> <span class="st">&quot;MARTES&quot;</span><span class="op">;</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span><span class="op">;</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">...</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">case</span> <span class="dv">6</span><span class="op">:</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    diaStr <span class="op">=</span> <span class="st">&quot;DOMINGO&quot;</span><span class="op">;</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span><span class="op">;</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

</section>
<section class="slide level2">

<ul>
<li><p>Es posible utilizar <code>switch</code> como expresión:</p>
<div class="sourceCode" id="cb28"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> diaSemana <span class="op">=</span> <span class="op">;</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="bu">String</span> diaStr <span class="op">=</span> <span class="cf">switch</span><span class="op">(</span>diaSemana<span class="op">)</span> <span class="op">{</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>                  <span class="cf">case</span> <span class="dv">0</span> <span class="op">-&gt;</span> <span class="st">&quot;LUNES&quot;</span><span class="op">;</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                  <span class="cf">case</span> <span class="dv">1</span> <span class="op">-&gt;</span> <span class="st">&quot;MARTES&quot;</span><span class="op">;</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                  <span class="kw">...</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                  <span class="cf">case</span> <span class="dv">6</span> <span class="op">-&gt;</span> <span class="st">&quot;DOMINGO&quot;</span><span class="op">;</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                  <span class="kw">default</span> <span class="op">-&gt;</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                <span class="op">};</span></span></code></pre></div>
</li>
<li><p>Tras cada <code>case</code> se coloca una flecha
(<code>-&gt;</code>) en lugar de dos puntos (<code>:</code>).</p></li>
<li><p>Al lado derecho de cada <code>-&gt;</code> se coloca una
expresión.</p></li>
<li><p>Es necesario un caso <code>default</code> <em>(salvo
excepciones)</em>.</p></li>
</ul>
</section>
<section class="slide level2">

<ul>
<li>Es posible agrupar varios casos en un mismo <code>case</code>:</li>
</ul>
<div class="sourceCode" id="cb29"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="kw">enum</span> Mes <span class="op">{</span> ENERO<span class="op">,</span> FEBRERO<span class="op">,</span> MARZO<span class="op">,</span> ABRIL<span class="op">,</span> MAYO<span class="op">,</span> JUNIO<span class="op">,</span> JULIO<span class="op">,</span> </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>           AGOSTO<span class="op">,</span> SEPTIEMBRE<span class="op">,</span> OCTUBRE<span class="op">,</span> NOVIEMBRE<span class="op">,</span> DICIEMBRE <span class="op">};</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="dt">static</span> <span class="dt">int</span> <span class="fu">numDias</span><span class="op">(</span>Mes m<span class="op">,</span> <span class="dt">boolean</span> esBisiesto<span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="cf">switch</span><span class="op">(</span>m<span class="op">)</span> <span class="op">{</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Mes<span class="op">.</span><span class="fu">FEBRERO</span> <span class="op">-&gt;</span> esBisiesto <span class="op">?</span> <span class="dv">29</span> <span class="op">:</span> <span class="dv">28</span><span class="op">;</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="hl">Mes<span class="op">.</span><span class="fu">ABRIL</span><span class="op">,</span> Mes<span class="op">.</span><span class="fu">JUNIO</span><span class="op">,</span> Mes<span class="op">.</span><span class="fu">SEPTIEMBRE</span><span class="op">,</span> Mes<span class="op">.</span><span class="fu">NOVIEMBRE</span></span> <span class="op">-&gt;</span> <span class="dv">30</span><span class="op">;</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">default</span> <span class="op">-&gt;</span> <span class="dv">31</span><span class="op">;</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span>  </span></code></pre></div>

<ul>
<li>Cuando hacemos distinción exhaustiva sobre los valores de un tipo
<code>enum</code> no es necesaria una rama <code>default</code>.</li>
</ul>
</section>
<section id="section-4" class="slide level2 ext"
data-background-image="img/Extension.jpg">
<h2 class="ext" data-background-image="img/Extension.jpg"></h2>
<ul>
<li>Dentro de cada rama de una expresión <code>switch</code> es posible
escribir sentencias, siempre que contengan un <code>yield</code> que
indique la expresión a devolver en esa rama del
<code>switch</code>:</li>
</ul>
<div class="sourceCode" id="cb30"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="dt">static</span> <span class="dt">int</span> <span class="fu">numDias</span><span class="op">(</span>Mes m<span class="op">,</span> <span class="dt">int</span> anyo<span class="op">)</span> <span class="op">{</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="cf">switch</span><span class="op">(</span>m<span class="op">)</span> <span class="op">{</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Mes<span class="op">.</span><span class="fu">FEBRERO</span> <span class="op">-&gt;</span> <span class="hl"><span class="op">{</span></span>   <span class="arrow_box_left"> Bloque de sentencias entre `{` y `}` </span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">boolean</span> esBisiesto <span class="op">=</span> <span class="fu">comprobarBisiesto</span><span class="op">(</span>anyo<span class="op">);</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> <span class="op">(</span>esBisiesto<span class="op">)</span> <span class="op">{</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>        <span class="hl">yield <span class="dv">29</span><span class="op">;</span></span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>      <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>        <span class="hl">yield <span class="dv">28</span><span class="op">;</span></span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>      <span class="op">}</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>    <span class="hl"><span class="op">}</span></span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ...</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

</section>
<section class="slide level2">

<h3 id="switch-como-alternativa-a-instanceof"><code>switch</code> como
alternativa a <code>instanceof</code></h3>
<ul>
<li><p>Las expresiones <code>switch</code> permiten distinguir casos
según el <strong>tipo</strong> del discriminante:</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">double</span> <span class="fu">area</span><span class="op">(</span>Figura f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="cf">switch</span><span class="op">(</span>f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>      <span class="cf">case</span> <span class="hl">Rectangulo r</span> <span class="op">-&gt;</span> r<span class="op">.</span><span class="fu">ancho</span><span class="op">()</span> <span class="op">*</span> r<span class="op">.</span><span class="fu">alto</span><span class="op">();</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>      <span class="cf">case</span> <span class="hl">Circulo c</span> <span class="op">-&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">PI</span> <span class="op">*</span> c<span class="op">.</span><span class="fu">radio</span><span class="op">()</span> <span class="op">*</span> c<span class="op">.</span><span class="fu">radio</span><span class="op">();</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>      <span class="cf">case</span> <span class="hl">Segmento _</span> <span class="op">-&gt;</span> <span class="dv">0</span><span class="op">;</span>                       <span class="arrow_box_left fragment"> Variable anónima: `_` </span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>      <span class="kw">default</span> <span class="op">-&gt;</span> <span class="cf">throw</span> <span class="bu">RuntimeException</span><span class="op">(</span><span class="st">&quot;Área no definida&quot;</span><span class="op">);</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">};</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</li>
</ul>
</section>
<section class="slide level2">

<h3 id="por-qué-el-default">¿Por qué el <code>default</code>?</h3>
<div>
<ul>
<li class="fragment"><p>En una expresión <code>switch</code>, la
distinción de casos ha de ser exhaustiva.</p></li>
<li class="fragment"><p>La interfaz <code>Figura</code> solamente tiene
tres clases: <code>Rectangulo</code>, <code>Circulo</code> y
<code>Segmento</code>.</p>
<ul>
<li class="fragment"><span class="rojo">…pero nada impide que se
declaren nuevas subclases de <code>Figura</code>, incluso en otros
módulos.</span></li>
</ul></li>
</ul>
</div>
<div class="info_box fragment">
<p>¿Cómo podemos prohibir nuevas subclases en <span
style="font-family: monospace">Figura</span>, aparte de las que hemos
definido nosotros?</p>
</div>
</section>
<section id="clases-selladas-sealed" class="slide level2">
<h2>Clases selladas (<code>sealed</code>)</h2>
<ul>
<li><p>Una clase <strong>sellada</strong> (<em>sealed</em>) no puede ser
extendida, salvo por algunas clases autorizadas.</p></li>
<li><p>En la definición de la clase sellada se indican aquellas clases
que están autorizadas a extenderla.</p></li>
<li><p>El mismo concepto se aplica a las interfaces.</p></li>
</ul>
<div class="sourceCode" id="cb32"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="hl">sealed</span> <span class="kw">interface</span> Figura </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>       <span class="hl">permits</span> Rectangulo<span class="op">,</span> Circulo<span class="op">,</span> Segmento <span class="op">{</span>   <span class="arrow_box_left fragment"> Herederas autorizadas </span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">//...</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

</section>
<section class="slide level2">

<ul>
<li><p>Como el tipo <code>Figura</code> está sellado y solamente puede
tener tres alternativas, ya no es necesario el caso <code>default</code>
en el <code>switch</code>, porque la distinción es exhaustiva.</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">double</span> <span class="fu">area</span><span class="op">(</span>Figura f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="cf">switch</span><span class="op">(</span>f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Rectangulo r <span class="op">-&gt;</span> r<span class="op">.</span><span class="fu">ancho</span><span class="op">()</span> <span class="op">*</span> r<span class="op">.</span><span class="fu">alto</span><span class="op">();</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Circulo c <span class="op">-&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">PI</span> <span class="op">*</span> c<span class="op">.</span><span class="fu">radio</span><span class="op">()</span> <span class="op">*</span> c<span class="op">.</span><span class="fu">radio</span><span class="op">();</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Segmento _ <span class="op">-&gt;</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</li>
</ul>
</section>
<section id="ajuste-de-patrones-mediante-switch" class="slide level2">
<h2>Ajuste de patrones mediante <code>switch</code></h2>
<ul>
<li><p>Si las clases sobre las que se hace ajuste son
<code>records</code>, es posible colocar los atributos de las clases en
el <code>case</code>:</p>
<div class="sourceCode" id="cb34"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">double</span> <span class="fu">area</span><span class="op">(</span>Figura f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="cf">switch</span> <span class="op">(</span>f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="fu">Rectangulo</span><span class="op">(</span>Punto _<span class="op">,</span> <span class="dt">double</span> ancho<span class="op">,</span> <span class="dt">double</span> alto<span class="op">)</span> <span class="op">-&gt;</span> ancho <span class="op">*</span> alto<span class="op">;</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="fu">Circulo</span><span class="op">(</span>Punto _<span class="op">,</span> <span class="dt">double</span> radio<span class="op">)</span> <span class="op">-&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">PI</span> <span class="op">*</span> radio <span class="op">*</span> radio<span class="op">;</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="fu">Segmento</span><span class="op">(</span>Punto _<span class="op">,</span> Punto _<span class="op">)</span> <span class="op">-&gt;</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</li>
</ul>
</section>
<section class="slide level2">

<ul>
<li><p>También se puede utilizar inferencia de tipos (<code>var</code>)
en los patrones:</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="dt">static</span> <span class="dt">double</span> <span class="fu">area</span><span class="op">(</span>Figura f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="cf">switch</span> <span class="op">(</span>f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="fu">Rectangulo</span><span class="op">(</span><span class="dt">var</span> _<span class="op">,</span> <span class="dt">var</span> ancho<span class="op">,</span> <span class="dt">var</span> alto<span class="op">)</span> <span class="op">-&gt;</span> ancho <span class="op">*</span> alto<span class="op">;</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="fu">Circulo</span><span class="op">(</span><span class="dt">var</span> _<span class="op">,</span> <span class="dt">var</span> radio<span class="op">)</span> <span class="op">-&gt;</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">PI</span> <span class="op">*</span> radio <span class="op">*</span> radio<span class="op">;</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="fu">Segmento</span><span class="op">(</span><span class="dt">var</span> _<span class="op">,</span> <span class="dt">var</span> _<span class="op">)</span> <span class="op">-&gt;</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</li>
</ul>
</section>
<section class="slide level2">

<ul>
<li><p>Se permiten guardas (mediante <code>when</code>) en los
patrones:</p>
<div class="sourceCode" id="cb36"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="dt">static</span> <span class="dt">boolean</span> <span class="fu">esHorizontal</span><span class="op">(</span>Figura f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="cf">switch</span> <span class="op">(</span>f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="fu">Segmento</span><span class="op">(</span><span class="fu">Punto</span><span class="op">(</span><span class="dt">var</span> _<span class="op">,</span> <span class="dt">var</span> y1<span class="op">),</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">Punto</span><span class="op">(</span><span class="dt">var</span> _<span class="op">,</span> <span class="dt">var</span> y2<span class="op">))</span> <span class="hl">when y1 <span class="op">==</span> y2</span> <span class="op">-&gt;</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">default</span> <span class="op">-&gt;</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</li>
</ul>
</section>
<section class="slide level2">

<h3 id="ventajas-e-inconvenientes-del-enfoque-funcional">Ventajas e
inconvenientes del enfoque funcional</h3>
<ul style="list-style:none;padding:0;margin:0">
<li class="hands_up fragment">
Todos los casos están en una misma función.
</li>
<li class="hands_up fragment">
<strong>Extensibilidad horizontal</strong>: es posible definir funciones
de manera externa a la jerarquía de clases.
</li>
<li class="hands_down fragment" style="margin-top:3em">
No hay extensibilidad vertical. El tipo unión está definido <em>a
priori</em> y no es posible añadir nuevas alternativas.
</li>
</ul>
</section>
<section id="comparativa-java-vs-elixir" class="slide level2">
<h2>Comparativa Java vs Elixir</h2>
<table>
<colgroup>
<col style="width: 35%" />
<col style="width: 40%" />
<col style="width: 23%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">Java</th>
<th style="text-align: center;">Elixir</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Extensibilidad horizontal</strong></td>
<td style="text-align: center;">Clases <code>sealed</code> <br/>+
<code>switch</code></td>
<td style="text-align: center;">Ajuste de patrones</td>
</tr>
<tr class="even">
<td><strong>Extensibilidad vertical</strong></td>
<td style="text-align: center;">Herencia <br/>+ métodos abstractos</td>
<td style="text-align: center;">Protocolos</td>
</tr>
</tbody>
</table>
</section></section>
<section>
<section id="gestión-de-errores-mediante-optionalt"
class="title-slide slide level1">
<h1>Gestión de errores mediante <code>Optional&lt;T&gt;</code></h1>

</section>
<section id="inconvenientes-del-uso-de-null" class="slide level2">
<h2>Inconvenientes del uso de <code>null</code></h2>
<ul>
<li><p>La forma tradicional de denotar ausencia de valores en Java es el
uso de <code>null</code>.</p>
<ul>
<li>Por ejemplo, el método <code>get()</code> de los diccionarios
devuelve <code>null</code> si no hay ningún valor asociado a la clave
indicada.</li>
</ul></li>
</ul>
<div class="fragment">
<ul>
<li><p>El uso de <code>null</code> para denotar ausencia de valores es
problemático <a href="11.html#/sobre-el-uso-de-null">[+]</a></p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">&lt;</span><span class="bu">Integer</span><span class="op">,</span> <span class="bu">String</span><span class="op">&gt;</span> dicc<span class="op">;</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co">// ...</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="dt">long</span> <span class="op">=</span> dicc<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="dv">3</span><span class="op">).</span><span class="fu">length</span><span class="op">();</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">// NullPointerException si `dicc` no contiene la clave 3</span></span></code></pre></div>
</li>
</ul>
</div>
</section>
<section id="la-clase-optionalt" class="slide level2">
<h2>La clase <code>Optional&lt;T&gt;</code></h2>
<p>Definida en paquete <code>java.util</code></p>
<ul>
<li><p>Define el tipo unión <em>option</em> explicado anteriormente <a
href="http://localhost:8080/11.html#/tipo-option">[+]</a>.</p></li>
<li><p>Las instancias de <code>Optional&lt;T&gt;</code> pueden contener
un objeto de tipo <code>T</code> o no contener ninguno.</p></li>
<li><p>El método <code>isPresent()</code> determina si una instancia de
<code>Optional&lt;T&gt;</code> contiene un objeto o no.</p></li>
<li><p>El método <code>get()</code> permite obtener el objeto contenido
dentro del <code>Optional&lt;T&gt;</code>, si existe.</p>
<ul>
<li>Lanza excepción si el <code>Optional&lt;T&gt;</code> no contiene
objeto.</li>
</ul></li>
</ul>
</section>
<section class="slide level2">

<div>
<ul>
<li class="fragment"><p>Si utilizamos <code>Optional&lt;T&gt;</code>, el
sistema de tipos nos avisa cuando estamos accediendo a un valor
potencialmente nulo.</p></li>
<li class="fragment"><p>Por ejemplo, supongamos que el método
<code>get()</code> de la clase <code>Map&lt;K, V&gt;</code> estuviera
definido del siguiente modo:</p>
<div class="sourceCode" id="cb38"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">interface</span> <span class="bu">Map</span><span class="op">&lt;</span>K<span class="op">,</span> V<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  Optional<span class="op">&lt;</span>V<span class="op">&gt;</span> <span class="fu">get</span><span class="op">(</span>K key<span class="op">);</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</li>
<li class="fragment"><p>El siguiente fragmento de código no
compilaría:</p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">&lt;</span><span class="bu">Integer</span><span class="op">,</span> <span class="bu">String</span><span class="op">&gt;</span> dicc<span class="op">;</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="co">// ...</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>      <span class="arrow_box_down"> Error: dicc.get(3) es de tipo `Optional&lt;String&gt;` </span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> longitud <span class="op">=</span> <span class="hl">dicc<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="dv">3</span><span class="op">)</span></span><span class="op">.</span><span class="fu">length</span><span class="op">();</span> </span></code></pre></div>
</li>
</ul>
</div>
</section>
<section class="slide level2">

<ul>
<li><p>En su lugar, deberíamos comprobar si el objeto está presente y
determinar qué hacer cuando no lo esté.</p>
<div class="sourceCode" id="cb40"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">&lt;</span><span class="bu">Integer</span><span class="op">,</span> <span class="bu">String</span><span class="op">&gt;</span> dicc<span class="op">;</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co">// ...</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> optStr <span class="op">=</span> dicc<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> longitud <span class="op">=</span> optStr<span class="op">.</span><span class="fu">isPresent</span><span class="op">()</span> <span class="op">?</span> optStr<span class="op">.</span><span class="fu">get</span><span class="op">().</span><span class="fu">length</span><span class="op">()</span> <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span></code></pre></div>
</li>
</ul>
</section>
<section id="construir-un-objeto-optionalt" class="slide level2">
<h2>Construir un objeto <code>Optional&lt;T&gt;</code></h2>
<dl>
<dt><code>Optional.of(T valor)</code></dt>
<dd>
<p>Construye un <code>Optional&lt;T&gt;</code> con el valor indicado,
siempre que sea distinto de <code>null</code>.</p>
</dd>
<dt><code>Optional.ofNullable(T valor)</code></dt>
<dd>
<p>Construye un <code>Optional&lt;T&gt;</code> con el valor indicado.
Construye un <code>Optional&lt;T&gt;</code> vacío si el valor pasado es
<code>null</code>.</p>
</dd>
<dt><code>Optional.empty()</code></dt>
<dd>
<p>Construye un <code>Optional&lt;T&gt;</code> vacío.</p>
</dd>
</dl>
</section>
<section class="slide level2">

<h3 id="ejemplo">Ejemplo</h3>
<ul>
<li><p>Volviendo a la interfaz original de <code>Map</code> (aquella en
la que <code>get()</code> devuelve <code>null</code> cuando la clave a
buscar no existe):</p>
<div class="sourceCode" id="cb41"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">&lt;</span><span class="bu">Integer</span><span class="op">,</span> <span class="bu">String</span><span class="op">&gt;</span> dicc<span class="op">;</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="co">// ...</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> optStr <span class="op">=</span> Optional<span class="op">.</span><span class="fu">ofNullable</span><span class="op">(</span>dicc<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="dv">3</span><span class="op">));</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> longitud <span class="op">=</span> optStr<span class="op">.</span><span class="fu">isPresent</span><span class="op">()</span> <span class="op">?</span> optStr<span class="op">.</span><span class="fu">get</span><span class="op">().</span><span class="fu">length</span><span class="op">()</span> <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span></code></pre></div>
</li>
</ul>
</section>
<section id="métodos-map-flatmap-y-orelse" class="slide level2">
<h2>Métodos <code>map</code>, <code>flatMap</code> y
<code>orElse</code></h2>
<div class="sourceCode" id="cb42"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Optional<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="op">{</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> Optional<span class="op">&lt;</span>U<span class="op">&gt;</span> <span class="fu">map</span><span class="op">(</span>Function<span class="op">&lt;</span>T<span class="op">,</span> U<span class="op">&gt;</span> f<span class="op">);</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> Optional<span class="op">&lt;</span>U<span class="op">&gt;</span> <span class="fu">flatMap</span><span class="op">(</span>Function<span class="op">&lt;</span>T<span class="op">,</span> Optional<span class="op">&lt;</span>U<span class="op">&gt;&gt;</span> f<span class="op">);</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">public</span> T <span class="fu">orElse</span><span class="op">(</span>T other<span class="op">);</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

<ul>
<li>Permiten ahorrarnos las distinciones de casos mediante
<code>isPresent()</code>.</li>
</ul>
</section>
<section class="slide level2">

<h3 id="ejemplo-1">Ejemplo</h3>
<p>Partimos del siguiente código:</p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="fu">longitudPrimero</span><span class="op">(</span><span class="bu">Map</span><span class="op">&lt;</span><span class="bu">Integer</span><span class="op">,</span> <span class="bu">TreeSet</span><span class="op">&lt;</span><span class="bu">String</span><span class="op">&gt;&gt;</span> dicc<span class="op">)</span> <span class="op">{</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">var</span> optSet <span class="op">=</span> Optional<span class="op">.</span><span class="fu">ofNullable</span><span class="op">(</span>dicc<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="dv">3</span><span class="op">));</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>optSet<span class="op">.</span><span class="fu">isPresent</span><span class="op">())</span> <span class="op">{</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">var</span> optStr <span class="op">=</span> Optional<span class="op">.</span><span class="fu">ofNullable</span><span class="op">(</span>optSet<span class="op">.</span><span class="fu">get</span><span class="op">().</span><span class="fu">pollFirst</span><span class="op">());</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> optStr<span class="op">.</span><span class="fu">isPresent</span><span class="op">()</span> <span class="op">?</span> optStr<span class="op">.</span><span class="fu">get</span><span class="op">().</span><span class="fu">length</span><span class="op">()</span> <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

</section>
<section class="slide level2">

<h3 id="método-orelse">Método <code>orElse</code></h3>
<div class="sourceCode" id="cb44"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>Optional<span class="op">&lt;</span>T<span class="op">&gt;.</span><span class="fu">orElse</span><span class="op">(</span>T other<span class="op">)</span> <span class="op">--&gt;</span> T</span></code></pre></div>

<ul>
<li><p>Obtiene un objeto de tipo <code>T</code> a partir de un
<code>Optional&lt;T&gt;</code>.</p>
<ul>
<li>Si el <code>Optional&lt;T&gt;</code> está vacío, devuelve el valor
<code>other</code>.</li>
<li>Si no, devuelve el objeto contenido dentro del
<code>Optional&lt;T&gt;</code>.</li>
</ul></li>
<li><p>Sirve para abreviar expresiones como la siguiente:</p>
<div class="sourceCode" id="cb45"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>opt<span class="op">.</span><span class="fu">isPresent</span><span class="op">()</span> <span class="op">?</span> opt<span class="op">.</span><span class="fu">get</span><span class="op">()</span> <span class="op">:</span> valor_defecto</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co">// equivale a</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>opt<span class="op">.</span><span class="fu">orElse</span><span class="op">(</span>valor_defecto<span class="op">)</span></span></code></pre></div>
</li>
</ul>
</section>
<section class="slide level2">

<h3 id="método-map">Método <code>map</code></h3>
<div class="sourceCode" id="cb46"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>Optional<span class="op">&lt;</span>T<span class="op">&gt;.</span><span class="fu">map</span><span class="op">(</span>Function<span class="op">&lt;</span>T<span class="op">,</span> U<span class="op">&gt;</span> f<span class="op">)</span> <span class="op">--&gt;</span> Optional<span class="op">&lt;</span>U<span class="op">&gt;</span></span></code></pre></div>

<ul>
<li><p>Transforma un <code>Optional&lt;T&gt;</code> en un
<code>Optional&lt;U&gt;</code>:</p>
<ul>
<li><p>Si el <code>Optional&lt;T&gt;</code> sobre el que se aplica está
vacío, devuelve un <code>Optional&lt;U&gt;</code> vacío.</p></li>
<li><p>Si contiene un valor, devuelve un <code>Optional&lt;U&gt;</code>
cuyo contenido es el resultado de aplicar <code>f</code> sobre dicho
valor.</p></li>
<li><p>Si <code>f</code> devuelve <code>null</code>, devuelve un
<code>Optional&lt;U&gt;</code> vacío.</p></li>
</ul></li>
<li><p>Sirve para abreviar expresiones como la siguiente:</p>
<div class="sourceCode" id="cb47"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>opt<span class="op">.</span><span class="fu">isPresent</span><span class="op">()</span> <span class="op">?</span> <span class="fu">f</span><span class="op">(</span>opt<span class="op">.</span><span class="fu">get</span><span class="op">())</span> <span class="op">:</span> Optional<span class="op">.</span><span class="fu">empty</span><span class="op">()</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co">// equivale a</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>opt<span class="op">.</span><span class="fu">map</span><span class="op">(</span>f<span class="op">)</span></span></code></pre></div>
</li>
</ul>
</section>
<section class="slide level2">

<p>En lugar de:</p>
<div class="sourceCode" id="cb48"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="fu">longitudPrimero</span><span class="op">(</span><span class="bu">Map</span><span class="op">&lt;</span><span class="bu">Integer</span><span class="op">,</span> <span class="bu">TreeSet</span><span class="op">&lt;</span><span class="bu">String</span><span class="op">&gt;&gt;</span> dicc<span class="op">)</span> <span class="op">{</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">var</span> optSet <span class="op">=</span> Optional<span class="op">.</span><span class="fu">ofNullable</span><span class="op">(</span>dicc<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="dv">3</span><span class="op">));</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>optSet<span class="op">.</span><span class="fu">isPresent</span><span class="op">())</span> <span class="op">{</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">var</span> optStr <span class="op">=</span> Optional<span class="op">.</span><span class="fu">ofNullable</span><span class="op">(</span>optSet<span class="op">.</span><span class="fu">get</span><span class="op">().</span><span class="fu">pollFirst</span><span class="op">());</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> optStr<span class="op">.</span><span class="fu">isPresent</span><span class="op">()</span> <span class="op">?</span> optStr<span class="op">.</span><span class="fu">get</span><span class="op">().</span><span class="fu">length</span><span class="op">()</span> <span class="op">:</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span> <span class="co">/* ... */</span> <span class="op">}</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

<p>Podemos escribir:</p>
<div class="sourceCode" id="cb49"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="fu">longitudPrimero</span><span class="op">(</span><span class="bu">Map</span><span class="op">&lt;</span><span class="bu">Integer</span><span class="op">,</span> <span class="bu">TreeSet</span><span class="op">&lt;</span><span class="bu">String</span><span class="op">&gt;&gt;</span> dicc<span class="op">)</span> <span class="op">{</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">var</span> optSet <span class="op">=</span> Optional<span class="op">.</span><span class="fu">ofNullable</span><span class="op">(</span>dicc<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="dv">3</span><span class="op">));</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>optSet<span class="op">.</span><span class="fu">isPresent</span><span class="op">())</span> <span class="op">{</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">var</span> optStr <span class="op">=</span> Optional<span class="op">.</span><span class="fu">ofNullable</span><span class="op">(</span>optSet<span class="op">.</span><span class="fu">get</span><span class="op">().</span><span class="fu">pollFirst</span><span class="op">());</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="hl">optStr<span class="op">.</span><span class="fu">map</span><span class="op">(</span><span class="bu">String</span><span class="op">::</span>length<span class="op">).</span><span class="fu">orElse</span><span class="op">(</span><span class="dv">0</span><span class="op">);</span></span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span> <span class="co">/* ... */</span> <span class="op">}</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

</section>
<section class="slide level2">

<ul>
<li>La llamada a <code>pollFirst</code> puede simplificarse mediante
<code>map</code>:</li>
</ul>
<div class="sourceCode" id="cb50"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="fu">longitudPrimero</span><span class="op">(</span><span class="bu">Map</span><span class="op">&lt;</span><span class="bu">Integer</span><span class="op">,</span> <span class="bu">TreeSet</span><span class="op">&lt;</span><span class="bu">String</span><span class="op">&gt;&gt;</span> dicc<span class="op">)</span> <span class="op">{</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">var</span> optSet <span class="op">=</span> Optional<span class="op">.</span><span class="fu">ofNullable</span><span class="op">(</span>dicc<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="dv">3</span><span class="op">));</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span>optSet<span class="op">.</span><span class="fu">isPresent</span><span class="op">())</span> <span class="op">{</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> optSet<span class="op">.</span><span class="fu">map</span><span class="op">(</span><span class="bu">TreeSet</span><span class="op">&lt;</span><span class="bu">String</span><span class="op">&gt;::</span>pollFirst<span class="op">)</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>                 <span class="op">.</span><span class="fu">map</span><span class="op">(</span><span class="bu">String</span><span class="op">::</span>length<span class="op">).</span><span class="fu">orElse</span><span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span> </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

</section>
<section class="slide level2">

<ul>
<li>También podemos simplificar la distinción de casos inicial sobre
<code>optSet</code>:</li>
</ul>
<div class="sourceCode" id="cb51"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> <span class="fu">longitudPrimero</span><span class="op">(</span><span class="bu">Map</span><span class="op">&lt;</span><span class="bu">Integer</span><span class="op">,</span> <span class="bu">TreeSet</span><span class="op">&lt;</span><span class="bu">String</span><span class="op">&gt;&gt;</span> dicc<span class="op">)</span> <span class="op">{</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> Optional<span class="op">.</span><span class="fu">ofNullable</span><span class="op">(</span>dicc<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="dv">3</span><span class="op">))</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">map</span><span class="op">(</span><span class="bu">TreeSet</span><span class="op">&lt;</span><span class="bu">String</span><span class="op">&gt;::</span>pollFirst<span class="op">)</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">map</span><span class="op">(</span><span class="bu">String</span><span class="op">::</span>length<span class="op">)</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>          <span class="op">.</span><span class="fu">orElse</span><span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

</section></section>
<section>
<section id="estructuras-de-datos-persistentes"
class="title-slide slide level1">
<h1>Estructuras de datos persistentes</h1>

</section>
<section id="colecciones-en-la-biblioteca-estándar-de-java"
class="slide level2">
<h2>Colecciones en la biblioteca estándar de Java</h2>
<ul>
<li><p>Las colecciones de la biblioteca estándar de Java
(<code>List</code>, <code>Map</code>, <code>Set</code>, etc.) definen
métodos cuya finalidad es mutar la colección sobre la que se aplican.
Por ejemplo:</p>
<ul>
<li><code>void List&lt;T&gt;.add(T elem)</code></li>
<li><code>void Map&lt;K, V&gt; put(K key, V value)</code></li>
</ul></li>
<li><p>Algunas de las implementaciones de esta interfaz se consideran
<em>inmutables</em>, en el sentido en el que prohiben las llamadas a las
operaciones mutadoras.</p></li>
</ul>
</section>
<section id="estructuras-de-datos-persistentes-1" class="slide level2">
<h2>Estructuras de datos persistentes</h2>
<div>
<ul>
<li class="fragment"><p>Una estructura de datos
<strong>persistente</strong> es inmutable, pero no prohíbe las llamadas
a operaciones mutadoras.</p></li>
<li class="fragment"><p>Una llamada a una operación mutadora devuelve
una <strong>copia</strong> de la estructura original, de modo que es
posible acceder tanto a la estructura original como a la resultante de
la operación.</p></li>
<li class="fragment"><p>La copia realizada puede tener
<strong>compartición</strong> de elementos con la estructura original,
por motivos de eficiencia.</p></li>
</ul>
</div>
</section>
<section class="slide level2">

<h3 id="implementaciones-de-estructuras-persistentes">Implementaciones
de estructuras persistentes</h3>
<div class="columns">
<div class="column fragment">
<p>Listas enlazadas</p>
<p><img data-src="17/Listas.svg" /></p>
</div><div class="column fragment">
<p><em>Bitmapped Vector Tries</em></p>
<p><img data-src="17/BitmappedVectorTrie.svg" /></p>
</div><div class="column fragment">
<p>Árboles binarios de búsqueda equilibrados</p>
<p><img data-src="17/ABB.svg" /></p>
</div>
</div>
</section>
<section id="listas-enlazadas-persistentes" class="slide level2">
<h2>Listas enlazadas persistentes</h2>
<ul>
<li><p>En la mayoría de lenguajes funcionales, las listas son un tipo
unión que resulta de aplicar reiteradamente un constructor de
listas.</p></li>
<li><p>Una lista puede ser:</p>
<ul>
<li><p>Vacía <br/> <code>[]</code> en Haskell y <code>[]</code> en
Elixir</p></li>
<li><p>No vacía, con cabeza <code>x</code> y cola <code>xs</code> <br/>
<code>(x:xs)</code> en Haskell y <code>[x|xs]</code> en Elixir<br/> A
este constructor de listas se le denomina
<strong><em>cons</em></strong>.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level2">

<ul>
<li>Podemos implementar listas enlazadas persistentes en Java como un
tipo unión:</li>
</ul>
<div class="sourceCode" id="cb52"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">sealed</span> <span class="kw">interface</span> IList<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="kw">permits</span> Empty<span class="op">,</span> Cons <span class="op">{</span> <span class="op">}</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="kw">record</span> Empty<span class="op">&lt;</span>T<span class="op">&gt;()</span> <span class="kw">implements</span> IList<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="op">{</span> <span class="op">}</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="kw">record</span> Cons<span class="op">&lt;</span>T<span class="op">&gt;(</span>T head<span class="op">,</span> IList<span class="op">&lt;</span>T<span class="op">&gt;</span> tail<span class="op">)</span> <span class="kw">implements</span> IList<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="op">{</span> <span class="op">}</span></span></code></pre></div>

<ul>
<li>Implementamos las funciones sobre listas como métodos
<code>default</code> dentro de la interfaz
<code>IList&lt;T&gt;</code>.</li>
</ul>
</section>
<section class="slide level2">

<h3 id="longitud-de-una-lista">Longitud de una lista</h3>
<div class="sourceCode" id="cb53"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="kw">default</span> <span class="dt">int</span> <span class="fu">length</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="cf">switch</span> <span class="op">(</span><span class="kw">this</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Empty<span class="op">&lt;</span>T<span class="op">&gt;</span> _ <span class="op">-&gt;</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Cons<span class="op">&lt;</span>T<span class="op">&gt;</span> v <span class="op">-&gt;</span> <span class="dv">1</span> <span class="op">+</span> v<span class="op">.</span><span class="fu">tail</span><span class="op">().</span><span class="fu">length</span><span class="op">();</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

<h3 id="concatenar-dos-listas">Concatenar dos listas</h3>
<div class="sourceCode" id="cb54"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="kw">default</span> IList<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="fu">append</span><span class="op">(</span>IList<span class="op">&lt;</span>T<span class="op">&gt;</span> other<span class="op">)</span> <span class="op">{</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="cf">switch</span> <span class="op">(</span><span class="kw">this</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Empty<span class="op">&lt;</span>T<span class="op">&gt;</span> _ <span class="op">-&gt;</span> other<span class="op">;</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Cons<span class="op">&lt;</span>T<span class="op">&gt;</span> v <span class="op">-&gt;</span> <span class="kw">new</span> Cons<span class="op">&lt;&gt;(</span>v<span class="op">.</span><span class="fu">head</span><span class="op">(),</span> v<span class="op">.</span><span class="fu">tail</span><span class="op">().</span><span class="fu">append</span><span class="op">(</span>other<span class="op">));</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

</section>
<section class="slide level2">

<ul>
<li><p>La concatenación de listas genera una copia de la lista
<code>this</code>:</p>
<div class="sourceCode" id="cb55"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> xs <span class="op">=</span> IList<span class="op">.</span><span class="fu">of</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">5</span><span class="op">);</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> ys <span class="op">=</span> IList<span class="op">.</span><span class="fu">of</span><span class="op">(</span><span class="dv">6</span><span class="op">,</span> <span class="dv">9</span><span class="op">,</span> <span class="op">-</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> zs <span class="op">=</span> xs<span class="op">.</span><span class="fu">append</span><span class="op">(</span>ys<span class="op">);</span></span></code></pre></div>

<p><svg
   width="164.35992mm"
   height="58.026165mm"
   viewBox="0 0 164.35992 58.026164"
   version="1.1"
   id="svg1"
   sodipodi:docname="ConcatListas.svg"
   inkscape:version="1.4 (e7c3feb100, 2024-10-09)"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <sodipodi:namedview
     id="namedview1"
     pagecolor="#ffffff"
     bordercolor="#000000"
     borderopacity="0.25"
     inkscape:showpageshadow="2"
     inkscape:pageopacity="0.0"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#d1d1d1"
     inkscape:document-units="mm"
     inkscape:zoom="1.4378367"
     inkscape:cx="385.6488"
     inkscape:cy="149.18245"
     inkscape:window-width="1920"
     inkscape:window-height="1011"
     inkscape:window-x="0"
     inkscape:window-y="0"
     inkscape:window-maximized="1"
     inkscape:current-layer="layer1" />
  <defs
     id="defs1">
    <marker
       style="overflow:visible"
       id="Dot"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-6"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-1" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-0"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-6" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-5"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-5" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-4"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-7" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-6-7"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-1-9" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-0-0"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-6-3" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-5-3"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-5-3" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-4-7"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-7-3" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-6-7-9"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-1-9-2" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-0-0-8"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-6-3-3" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-5-3-0"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-5-3-1" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-4-7-7"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-7-3-8" />
    </marker>
  </defs>
  <g
     inkscape:label="Capa 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(30.021707,8.3098166)">
    <g
       id="g1">
      <rect
         style="fill:#daf7ff;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1"
         width="11.408922"
         height="11.408922"
         x="40.299255"
         y="15.273233" />
      <rect
         style="fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2"
         width="4.9684019"
         height="11.408922"
         x="51.696243"
         y="15.273233" />
    </g>
    <g
       id="g2"
       transform="translate(29.048477)">
      <rect
         style="fill:#daf7ff;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-0"
         width="11.408922"
         height="11.408922"
         x="40.299255"
         y="15.273233" />
      <rect
         style="fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-9"
         width="4.9684019"
         height="11.408922"
         x="51.696243"
         y="15.273233" />
    </g>
    <g
       id="g2-2"
       transform="translate(58.096955)">
      <rect
         style="fill:#daf7ff;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-6"
         width="11.408922"
         height="11.408922"
         x="40.299255"
         y="15.273233" />
      <rect
         style="fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-1"
         width="4.9684019"
         height="11.408922"
         x="51.696243"
         y="15.273233" />
    </g>
    <g
       id="g2-0"
       transform="translate(77.755094,3.4839665)">
      <rect
         style="fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-7"
         width="4.6923804"
         height="4.5083647"
         x="51.696243"
         y="15.273233" />
    </g>
    <text
       xml:space="preserve"
       style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
       x="46.452187"
       y="23.941742"
       id="text1"><tspan
         sodipodi:role="line"
         id="tspan1"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
         x="46.452187"
         y="23.941742">6</tspan></text>
    <text
       xml:space="preserve"
       style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
       x="75.55101"
       y="23.711565"
       id="text1-3"><tspan
         sodipodi:role="line"
         id="tspan1-1"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
         x="75.55101"
         y="23.711565">9</tspan></text>
    <g
       id="g1-8"
       transform="translate(57.369821,-0.3208782)">
      <text
         xml:space="preserve"
         style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
         x="46.452187"
         y="23.941742"
         id="text1-4"><tspan
           sodipodi:role="line"
           id="tspan1-5"
           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="46.452187"
           y="23.941742">-3</tspan></text>
    </g>
    <path
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot);marker-end:url(#ArrowWide)"
       d="M 54.389392,20.818906 H 69.222863"
       id="path1" />
    <path
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-6);marker-end:url(#ArrowWide-0)"
       d="m 83.111586,20.818906 h 14.83347"
       id="path1-0" />
    <path
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-5);marker-end:url(#ArrowWide-4)"
       d="m 112.41424,20.818906 h 16.78524"
       id="path1-6"
       sodipodi:nodetypes="cc" />
    <g
       id="g3"
       transform="translate(-42.793097,-23.38855)">
      <rect
         style="fill:#daf7ff;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-0-8"
         width="11.408922"
         height="11.408922"
         x="40.299255"
         y="15.273233" />
      <rect
         style="fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-9-7"
         width="4.9684019"
         height="11.408922"
         x="51.696243"
         y="15.273233" />
    </g>
    <g
       id="g2-2-9"
       transform="translate(-13.74462,-23.38855)">
      <rect
         style="fill:#daf7ff;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-6-6"
         width="11.408922"
         height="11.408922"
         x="40.299255"
         y="15.273233" />
      <rect
         style="fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-1-0"
         width="4.9684019"
         height="11.408922"
         x="51.696243"
         y="15.273233" />
    </g>
    <g
       id="g2-0-4"
       transform="translate(5.9135197,-19.904584)">
      <rect
         style="fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-7-1"
         width="4.6923804"
         height="4.5083647"
         x="51.696243"
         y="15.273233" />
    </g>
    <text
       xml:space="preserve"
       style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
       x="3.7094347"
       y="0.32301602"
       id="text1-3-8"><tspan
         sodipodi:role="line"
         id="tspan1-1-7"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
         x="3.7094347"
         y="0.32301602">1</tspan></text>
    <g
       id="g1-8-0"
       transform="translate(-14.471754,-23.709428)">
      <text
         xml:space="preserve"
         style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
         x="46.452187"
         y="23.941742"
         id="text1-4-8"><tspan
           sodipodi:role="line"
           id="tspan1-5-6"
           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="46.452187"
           y="23.941742">5</tspan></text>
    </g>
    <path
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-6-7);marker-end:url(#ArrowWide-0-0)"
       d="m 11.270012,-2.5696428 h 14.83347"
       id="path1-0-4" />
    <path
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-5-3);marker-end:url(#ArrowWide-4-7)"
       d="m 40.572666,-2.5696428 h 16.78524"
       id="path1-6-7"
       sodipodi:nodetypes="cc" />
    <g
       id="g3-5"
       transform="translate(-57.62548,22.839692)" />
    <text
       xml:space="preserve"
       style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
       x="-13.623642"
       y="-0.38040584"
       id="text1-3-8-97"><tspan
         sodipodi:role="line"
         id="tspan1-1-7-8"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
         x="-13.623642"
         y="-0.38040584">xs</tspan></text>
    <text
       xml:space="preserve"
       style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
       x="30.567287"
       y="23.11095"
       id="text1-3-8-97-9"><tspan
         sodipodi:role="line"
         id="tspan1-1-7-8-0"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
         x="30.567287"
         y="23.11095">ys</tspan></text>
    <g
       id="g4"
       class="fragment">
      <rect
         style="fill:#daf7ff;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-0-8-4"
         width="11.408922"
         height="11.408922"
         x="40.299255"
         y="15.273233"
         transform="translate(-57.62548,22.839693)" />
      <rect
         style="fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-9-7-9"
         width="4.9684019"
         height="11.408922"
         x="51.696243"
         y="15.273233"
         transform="translate(-57.62548,22.839693)" />
      <g
         id="g2-2-9-2"
         transform="translate(-28.577003,22.839692)">
        <rect
           style="fill:#daf7ff;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-6-6-5"
           width="11.408922"
           height="11.408922"
           x="40.299255"
           y="15.273233" />
        <rect
           style="fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-2-1-0-7"
           width="4.9684019"
           height="11.408922"
           x="51.696243"
           y="15.273233" />
      </g>
      <text
         xml:space="preserve"
         style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
         x="-11.122949"
         y="46.551254"
         id="text1-3-8-9"><tspan
           sodipodi:role="line"
           id="tspan1-1-7-4"
           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="-11.122949"
           y="46.551254">1</tspan></text>
      <g
         id="g1-8-0-5"
         transform="translate(-29.304137,22.518814)">
        <text
           xml:space="preserve"
           style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
           x="46.452187"
           y="23.941742"
           id="text1-4-8-9"><tspan
             sodipodi:role="line"
             id="tspan1-5-6-3"
             style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
             x="46.452187"
             y="23.941742">5</tspan></text>
      </g>
      <path
         style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-6-7-9);marker-end:url(#ArrowWide-0-0-8)"
         d="M -3.5623708,43.658599 H 11.271099"
         id="path1-0-4-5" />
      <path
         style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-5-3-0);marker-end:url(#ArrowWide-4-7-7)"
         d="M 25.740283,43.658599 40.317345,26.729231"
         id="path1-6-7-7"
         sodipodi:nodetypes="cc" />
      <text
         xml:space="preserve"
         style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
         x="-26.063538"
         y="45.239479"
         id="text1-3-8-97-9-6"><tspan
           sodipodi:role="line"
           id="tspan1-1-7-8-0-2"
           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="-26.063538"
           y="45.239479">zs</tspan></text>
    </g>
  </g>
</svg>
</p></li>
</ul>
</section>
<section class="slide level2">

<ul>
<li><p>La búsqueda del elemento <code>n</code>-ésimo de una lista
requiere recorrer todos los anteriores:</p>
<div class="sourceCode" id="cb56"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="kw">default</span> T <span class="fu">at</span><span class="op">(</span><span class="dt">int</span> n<span class="op">)</span> <span class="op">{</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="cf">switch</span> <span class="op">(</span><span class="kw">this</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Empty<span class="op">&lt;</span>T<span class="op">&gt;</span> _ <span class="op">-&gt;</span> <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">IndexOutOfBoundsException</span><span class="op">();</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Cons<span class="op">&lt;</span>T<span class="op">&gt;</span> _ when n <span class="op">&lt;</span> <span class="dv">0</span> <span class="op">-&gt;</span> <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">IndexOutOfBoundsException</span><span class="op">();</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Cons<span class="op">&lt;</span>T<span class="op">&gt;</span> v when n <span class="op">==</span> <span class="dv">0</span> <span class="op">-&gt;</span> v<span class="op">.</span><span class="fu">head</span><span class="op">();</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Cons<span class="op">&lt;</span>T<span class="op">&gt;</span> v <span class="op">-&gt;</span> v<span class="op">.</span><span class="fu">tail</span><span class="op">().</span><span class="fu">at</span><span class="op">(</span>n <span class="op">-</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</li>
</ul>
</section>
<section class="slide level2">

<h3 id="función-map">Función <code>map</code></h3>
<div class="sourceCode" id="cb57"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="kw">default</span> <span class="op">&lt;</span>U<span class="op">&gt;</span> IList<span class="op">&lt;</span>U<span class="op">&gt;</span> <span class="fu">map</span><span class="op">(</span>Function<span class="op">&lt;</span>T<span class="op">,</span> U<span class="op">&gt;</span> f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="cf">switch</span> <span class="op">(</span><span class="kw">this</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Empty<span class="op">&lt;</span>T<span class="op">&gt;</span> _ <span class="op">-&gt;</span> <span class="kw">new</span> Empty<span class="op">&lt;&gt;();</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Cons<span class="op">&lt;</span>T<span class="op">&gt;</span> v <span class="op">-&gt;</span> <span class="kw">new</span> Cons<span class="op">&lt;&gt;(</span>f<span class="op">.</span><span class="fu">apply</span><span class="op">(</span>v<span class="op">.</span><span class="fu">head</span><span class="op">()),</span> v<span class="op">.</span><span class="fu">tail</span><span class="op">().</span><span class="fu">map</span><span class="op">(</span>f<span class="op">));</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

<h3 id="función-foreach">Función <code>forEach</code></h3>
<div class="sourceCode" id="cb58"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="kw">default</span> <span class="dt">void</span> <span class="fu">forEach</span><span class="op">(</span>Consumer<span class="op">&lt;</span>T<span class="op">&gt;</span> f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> <span class="op">(</span><span class="kw">this</span> <span class="kw">instanceof</span> Cons<span class="op">&lt;</span>T<span class="op">&gt;(</span>T head<span class="op">,</span> IList<span class="op">&lt;</span>T<span class="op">&gt;</span> tail<span class="op">))</span> <span class="op">{</span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    f<span class="op">.</span><span class="fu">accept</span><span class="op">(</span>head<span class="op">);</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    tail<span class="op">.</span><span class="fu">forEach</span><span class="op">(</span>f<span class="op">);</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

</section>
<section class="slide level2">

<h3 id="función-reduce">Función <code>reduce</code></h3>
<div class="sourceCode" id="cb59"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="kw">default</span> <span class="op">&lt;</span>R<span class="op">&gt;</span> R <span class="fu">reduce</span><span class="op">(</span>R ini<span class="op">,</span> BiFunction<span class="op">&lt;</span>T<span class="op">,</span> R<span class="op">,</span> R<span class="op">&gt;</span> f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="cf">switch</span> <span class="op">(</span><span class="kw">this</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Empty<span class="op">&lt;</span>T<span class="op">&gt;</span> _ <span class="op">-&gt;</span> ini<span class="op">;</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Cons<span class="op">&lt;</span>T<span class="op">&gt;</span> v <span class="op">-&gt;</span> v<span class="op">.</span><span class="fu">tail</span><span class="op">().</span><span class="fu">reduce</span><span class="op">(</span>f<span class="op">.</span><span class="fu">apply</span><span class="op">(</span>v<span class="op">.</span><span class="fu">head</span><span class="op">(),</span> ini<span class="op">),</span> f<span class="op">);</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

<h3 id="función-reduceright">Función <code>reduceRight</code></h3>
<div class="sourceCode" id="cb60"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="kw">default</span> <span class="op">&lt;</span>R<span class="op">&gt;</span> R <span class="fu">reduceRight</span><span class="op">(</span>R ini<span class="op">,</span> BiFunction<span class="op">&lt;</span>T<span class="op">,</span> R<span class="op">,</span> R<span class="op">&gt;</span> f<span class="op">)</span> <span class="op">{</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="cf">switch</span> <span class="op">(</span><span class="kw">this</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Empty<span class="op">&lt;</span>T<span class="op">&gt;</span> _ <span class="op">-&gt;</span> ini<span class="op">;</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Cons<span class="op">&lt;</span>T<span class="op">&gt;</span> v <span class="op">-&gt;</span> f<span class="op">.</span><span class="fu">apply</span><span class="op">(</span>v<span class="op">.</span><span class="fu">head</span><span class="op">(),</span> v<span class="op">.</span><span class="fu">tail</span><span class="op">().</span><span class="fu">reduceRight</span><span class="op">(</span>ini<span class="op">,</span> f<span class="op">));</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

</section>
<section class="slide level2">

<ul>
<li>Implementación de <code>append</code> y <code>length</code>
utilizando las funciones <code>reduce</code>:</li>
</ul>
<div class="sourceCode" id="cb61"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="kw">default</span> <span class="dt">int</span> <span class="fu">length</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="fu">reduce</span><span class="op">(</span><span class="dv">0</span><span class="op">,</span> <span class="op">(</span>x<span class="op">,</span> l<span class="op">)</span> <span class="op">-&gt;</span> l <span class="op">+</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

<div class="sourceCode" id="cb62"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="kw">default</span> IList<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="fu">append</span><span class="op">(</span>IList<span class="op">&lt;</span>T<span class="op">&gt;</span> other<span class="op">)</span> <span class="op">{</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="fu">reduceRight</span><span class="op">(</span>other<span class="op">,</span> Cons<span class="op">&lt;</span>T<span class="op">&gt;::</span><span class="kw">new</span><span class="op">);</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

</section>
<section id="coste-de-las-operaciones" class="slide level2">
<h2>Coste de las operaciones</h2>
<table>
<thead>
<tr class="header">
<th></th>
<th>Coste</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Cons(x, xs)</code></td>
<td><span class="math inline"><em>O</em>(1)</span></td>
</tr>
<tr class="even">
<td><code>xs.head()</code></td>
<td><span class="math inline"><em>O</em>(1)</span></td>
</tr>
<tr class="odd">
<td><code>xs.last()</code></td>
<td><span
class="math inline"><em>O</em>(<em>x</em><em>s</em>)</span></td>
</tr>
<tr class="even">
<td><code>xs.length()</code></td>
<td><span
class="math inline"><em>O</em>(<em>x</em><em>s</em>)</span></td>
</tr>
<tr class="odd">
<td><code>xs.append(ys)</code></td>
<td><span
class="math inline"><em>O</em>(<em>x</em><em>s</em>)</span></td>
</tr>
<tr class="even">
<td><code>xs.at(i)</code></td>
<td><span class="math inline"><em>O</em>(<em>i</em>)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="bitmapped-vector-tries" class="slide level2">
<h2><em>Bitmapped Vector Tries</em></h2>
<ul>
<li><p>Es una estructura de vectores enlazados jerárquicamente.</p></li>
<li><p>Los vectores tienen una <strong>longitud fija</strong> <span
class="math inline"><em>K</em></span> tal que <span
class="math inline"><em>K</em> = 2<sup><em>n</em></sup></span> para
algún <span class="math inline"><em>n</em></span>.</p>
<ul>
<li><p>Normalmente se utiliza <span
class="math inline"><em>K</em> = 32</span>.</p></li>
<li><p>En estas diapositivas, utilizamos <span
class="math inline"><em>K</em> = 4</span> por motivos de
presentación.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level2">

<ul>
<li>Inicialmente, tenemos un vector de tamaño <span
class="math inline"><em>K</em></span>, que llenamos de izquierda a
derecha:</li>
</ul>
<p><svg
   width="45.957855mm"
   height="11.797922mm"
   viewBox="0 0 45.957855 11.797922"
   version="1.1"
   id="svg1"
   inkscape:version="1.4 (e7c3feb100, 2024-10-09)"
   sodipodi:docname="VTrie1.svg"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <sodipodi:namedview
     id="namedview1"
     pagecolor="#ffffff"
     bordercolor="#000000"
     borderopacity="0.25"
     inkscape:showpageshadow="2"
     inkscape:pageopacity="0.0"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#d1d1d1"
     inkscape:document-units="mm"
     inkscape:zoom="1.0167041"
     inkscape:cx="109.6681"
     inkscape:cy="-116.55309"
     inkscape:window-width="1920"
     inkscape:window-height="1011"
     inkscape:window-x="0"
     inkscape:window-y="0"
     inkscape:window-maximized="1"
     inkscape:current-layer="g2-3" />
  <defs
     id="defs1" />
  <g
     inkscape:label="Capa 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(-7.2837313,-46.788072)">
    <g
       id="g2"
       transform="translate(-51.121092,3.5888423)">
      <rect
         style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2"
         width="11.408922"
         height="11.408922"
         x="58.599323"
         y="43.39373" />
      <rect
         style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-7-2"
         width="11.408922"
         height="11.408922"
         x="69.98597"
         y="43.39373" />
      <rect
         style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-0-0"
         width="11.408922"
         height="11.408922"
         x="81.372612"
         y="43.39373" />
      <rect
         style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-6-5"
         width="11.408922"
         height="11.408922"
         x="92.759254"
         y="43.39373" />
    </g>
    <g
       id="g2-2"
       transform="translate(0.29238556,3.7586678)">
      <text
         xml:space="preserve"
         style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
         x="12.775527"
         y="52.131214"
         id="text1"><tspan
           sodipodi:role="line"
           id="tspan1"
           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="12.775527"
           y="52.131214">3</tspan></text>
      <text
         xml:space="preserve"
         style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
         x="23.97044"
         y="52.053604"
         id="text1-4"
         class="fragment"><tspan
           sodipodi:role="line"
           id="tspan1-6"
           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="23.97044"
           y="52.053604">-1</tspan></text>
      <text
         xml:space="preserve"
         style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
         x="35.716393"
         y="52.053604"
         id="text1-6"
         class="fragment"><tspan
           sodipodi:role="line"
           id="tspan1-4"
           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="35.716393"
           y="52.053604">5</tspan></text>
      <text
         xml:space="preserve"
         style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
         x="47.182945"
         y="52.131214"
         id="text1-9"
         class="fragment"><tspan
           sodipodi:role="line"
           id="tspan1-2"
           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="47.182945"
           y="52.131214">9</tspan></text>
      <g
         id="g2-3"
         transform="translate(5.9086504,0.0568023)">
        <rect
           style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-2-1"
           width="11.408922"
           height="11.408922"
           x="58.599323"
           y="43.39373" />
        <rect
           style="fill:#447b3e;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-7-2-1"
           width="11.408922"
           height="11.408922"
           x="69.98597"
           y="43.39373" />
        <rect
           style="fill:#447b3e;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-0-0-9"
           width="11.408922"
           height="11.408922"
           x="81.372612"
           y="43.39373" />
        <rect
           style="fill:#447b3e;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-6-5-0"
           width="11.408922"
           height="11.408922"
           x="92.759254"
           y="43.39373" />
      </g>
      <text
         xml:space="preserve"
         style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
         x="70.097656"
         y="52.357845"
         id="text1-5"><tspan
           sodipodi:role="line"
           id="tspan1-67"
           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="70.097656"
           y="52.357845">2</tspan></text>
    </g>
  </g>
</svg>
</p>
<div class="fragment">
<ul>
<li>Cuando queremos añadir un elemento al final y el vector está lleno:
<ul>
<li>Añadimos el nuevo elemento en un vector aparte.</li>
<li>Creamos un vector «padre» que apunte a ambos:</li>
</ul></li>
</ul>
<p><svg
   width="103.27998mm"
   height="43.323627mm"
   viewBox="0 0 103.27998 43.323627"
   version="1.1"
   id="svg1"
   inkscape:version="1.4 (e7c3feb100, 2024-10-09)"
   sodipodi:docname="VTrie2.svg"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <sodipodi:namedview
     id="namedview1"
     pagecolor="#ffffff"
     bordercolor="#000000"
     borderopacity="0.25"
     inkscape:showpageshadow="2"
     inkscape:pageopacity="0.0"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#d1d1d1"
     inkscape:document-units="mm"
     inkscape:zoom="1.0167041"
     inkscape:cx="109.6681"
     inkscape:cy="158.84661"
     inkscape:window-width="1920"
     inkscape:window-height="1011"
     inkscape:window-x="0"
     inkscape:window-y="0"
     inkscape:window-maximized="1"
     inkscape:current-layer="g2-2" />
  <defs
     id="defs1">
    <marker
       style="overflow:visible"
       id="ArrowWide"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path6" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17" />
    </marker>
  </defs>
  <g
     inkscape:label="Capa 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(-7.2837313,-15.488993)">
    <g
       id="g2"
       transform="translate(-51.121092,3.5888423)">
      <rect
         style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2"
         width="11.408922"
         height="11.408922"
         x="58.599323"
         y="43.39373" />
      <rect
         style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-7-2"
         width="11.408922"
         height="11.408922"
         x="69.98597"
         y="43.39373" />
      <rect
         style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-0-0"
         width="11.408922"
         height="11.408922"
         x="81.372612"
         y="43.39373" />
      <rect
         style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-6-5"
         width="11.408922"
         height="11.408922"
         x="92.759254"
         y="43.39373" />
    </g>
    <g
       id="g2-2"
       transform="translate(0.29238556,3.7586678)">
      <text
         xml:space="preserve"
         style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
         x="12.775527"
         y="52.131214"
         id="text1"><tspan
           sodipodi:role="line"
           id="tspan1"
           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="12.775527"
           y="52.131214">3</tspan></text>
      <text
         xml:space="preserve"
         style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
         x="23.97044"
         y="52.053604"
         id="text1-4"><tspan
           sodipodi:role="line"
           id="tspan1-6"
           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="23.97044"
           y="52.053604">-1</tspan></text>
      <text
         xml:space="preserve"
         style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
         x="35.716393"
         y="52.053604"
         id="text1-6"><tspan
           sodipodi:role="line"
           id="tspan1-4"
           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="35.716393"
           y="52.053604">5</tspan></text>
      <text
         xml:space="preserve"
         style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
         x="47.182945"
         y="52.131214"
         id="text1-9"><tspan
           sodipodi:role="line"
           id="tspan1-2"
           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="47.182945"
           y="52.131214">9</tspan></text>
      <g
         id="g1"
         class="fragment">
        <rect
           style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-2-1"
           width="11.408922"
           height="11.408922"
           x="64.507973"
           y="43.450531" />
        <rect
           style="fill:#447b3e;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-7-2-1"
           width="11.408922"
           height="11.408922"
           x="75.894623"
           y="43.450531" />
        <rect
           style="fill:#447b3e;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-0-0-9"
           width="11.408922"
           height="11.408922"
           x="87.281265"
           y="43.450531" />
        <rect
           style="fill:#447b3e;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-6-5-0"
           width="11.408922"
           height="11.408922"
           x="98.667908"
           y="43.450531" />
        <text
           xml:space="preserve"
           style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
           x="70.097656"
           y="52.357845"
           id="text1-5"><tspan
             sodipodi:role="line"
             id="tspan1-67"
             style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
             x="70.097656"
             y="52.357845">2</tspan></text>
      </g>
      <g
         id="g3"
         class="fragment">
        <g
           id="g2-8"
           transform="translate(-3.6379703,-31.468905)">
          <rect
             style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1"
             width="11.408922"
             height="11.408922"
             x="58.599323"
             y="43.39373" />
          <rect
             style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-7"
             width="11.408922"
             height="11.408922"
             x="69.98597"
             y="43.39373" />
          <rect
             style="fill:#478640;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-0"
             width="11.408922"
             height="11.408922"
             x="81.372612"
             y="43.39373" />
          <rect
             style="fill:#478640;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-6"
             width="11.408922"
             height="11.408922"
             x="92.759254"
             y="43.39373" />
        </g>
        <path
           style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot);marker-end:url(#ArrowWide)"
           d="M 60.158153,17.58757 31.79239,42.570257"
           id="path1"
           sodipodi:nodetypes="cc" />
        <path
           style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot);marker-end:url(#ArrowWide)"
           d="m 71.941513,17.492227 7.02638,25.50316"
           id="path2"
           sodipodi:nodetypes="cc" />
      </g>
    </g>
  </g>
</svg>
</p>
</div>
</section>
<section class="slide level2">

<p><img data-src="17/VTrie2.svg" /></p>
<ul>
<li><p>Si llenamos el segundo vector, añadimos un tercero, y así
sucesivamente.</p></li>
<li><p>Esto nos permite tener hasta 16 elementos.</p></li>
</ul>
<p><img data-src="17/VTrie3.svg" /></p>
</section>
<section class="slide level2">

<ul>
<li>Al insertar un elemento más, tenemos que añadir un nuevo nivel:</li>
</ul>
<p><svg
   width="294.50742mm"
   height="97.612167mm"
   viewBox="0 0 294.5074 97.612165"
   version="1.1"
   id="svg1"
   inkscape:version="1.4 (e7c3feb100, 2024-10-09)"
   sodipodi:docname="VTrie4.svg"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <sodipodi:namedview
     id="namedview1"
     pagecolor="#ffffff"
     bordercolor="#000000"
     borderopacity="0.25"
     inkscape:showpageshadow="2"
     inkscape:pageopacity="0.0"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#d1d1d1"
     inkscape:document-units="mm"
     inkscape:zoom="0.71891835"
     inkscape:cx="1038.3655"
     inkscape:cy="288.62805"
     inkscape:window-width="1920"
     inkscape:window-height="1011"
     inkscape:window-x="0"
     inkscape:window-y="0"
     inkscape:window-maximized="1"
     inkscape:current-layer="g2-2" />
  <defs
     id="defs1">
    <marker
       style="overflow:visible"
       id="ArrowWide"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path6" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-0"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-2" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-2"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path6-9" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-3"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-7" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-9"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path6-7" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-2"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-5" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-8"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path6-90" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-2-7"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-5-1" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-8-3"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path6-90-3" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-2-7-8"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-5-1-7" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-8-3-6"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path6-90-3-3" />
    </marker>
  </defs>
  <g
     inkscape:label="Capa 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(-7.0234945,38.521927)">
    <g
       id="g2-2"
       transform="translate(0.29238556,3.7586678)">
      <g
         id="g8"
         transform="translate(-0.26023632,0.44975262)">
        <g
           id="g2"
           transform="translate(-51.413478,-0.16982562)">
          <rect
             style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-2"
             width="11.408922"
             height="11.408922"
             x="58.599323"
             y="43.39373" />
          <rect
             style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-7-2"
             width="11.408922"
             height="11.408922"
             x="69.98597"
             y="43.39373" />
          <rect
             style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-0-0"
             width="11.408922"
             height="11.408922"
             x="81.372612"
             y="43.39373" />
          <rect
             style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-6-5"
             width="11.408922"
             height="11.408922"
             x="92.759254"
             y="43.39373" />
        </g>
        <text
           xml:space="preserve"
           style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
           x="12.775527"
           y="52.131214"
           id="text1"><tspan
             sodipodi:role="line"
             id="tspan1"
             style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
             x="12.775527"
             y="52.131214">3</tspan></text>
        <text
           xml:space="preserve"
           style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
           x="23.97044"
           y="52.053604"
           id="text1-4"><tspan
             sodipodi:role="line"
             id="tspan1-6"
             style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
             x="23.97044"
             y="52.053604">-1</tspan></text>
        <text
           xml:space="preserve"
           style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
           x="35.716393"
           y="52.053604"
           id="text1-6"><tspan
             sodipodi:role="line"
             id="tspan1-4"
             style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
             x="35.716393"
             y="52.053604">5</tspan></text>
        <text
           xml:space="preserve"
           style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
           x="47.182945"
           y="52.131214"
           id="text1-9"><tspan
             sodipodi:role="line"
             id="tspan1-2"
             style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
             x="47.182945"
             y="52.131214">9</tspan></text>
      </g>
      <g
         id="g1"
         transform="translate(-0.50152655,0.22312562)">
        <g
           id="g7">
          <rect
             style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-2-1"
             width="11.408922"
             height="11.408922"
             x="64.507973"
             y="43.450531" />
          <rect
             style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-7-2-1"
             width="11.408922"
             height="11.408922"
             x="75.894623"
             y="43.450531" />
          <rect
             style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-0-0-9"
             width="11.408922"
             height="11.408922"
             x="87.281265"
             y="43.450531" />
          <rect
             style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-6-5-0"
             width="11.408922"
             height="11.408922"
             x="98.667908"
             y="43.450531" />
          <text
             xml:space="preserve"
             style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
             x="70.097656"
             y="52.357845"
             id="text1-5"><tspan
               sodipodi:role="line"
               id="tspan1-67"
               style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
               x="70.097656"
               y="52.357845">2</tspan></text>
          <text
             xml:space="preserve"
             style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
             x="82.061638"
             y="52.365658"
             id="text1-5-3"><tspan
               sodipodi:role="line"
               id="tspan1-67-8"
               style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
               x="82.061638"
               y="52.365658">1</tspan></text>
          <g
             id="g1-3"
             transform="translate(22.478347,-0.10028051)">
            <text
               xml:space="preserve"
               style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
               x="70.097656"
               y="52.357845"
               id="text1-5-7"><tspan
                 sodipodi:role="line"
                 id="tspan1-67-87"
                 style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
                 x="70.097656"
                 y="52.357845">-1</tspan></text>
          </g>
          <g
             id="g1-0"
             transform="translate(34.215062,-0.16983331)">
            <text
               xml:space="preserve"
               style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
               x="70.097656"
               y="52.357845"
               id="text1-5-9"><tspan
                 sodipodi:role="line"
                 id="tspan1-67-88"
                 style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
                 x="70.097656"
                 y="52.357845">0</tspan></text>
          </g>
        </g>
      </g>
      <g
         id="g2-8"
         transform="translate(-3.6379703,-31.468905)">
        <rect
           style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1"
           width="11.408922"
           height="11.408922"
           x="58.599323"
           y="43.39373" />
        <rect
           style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-7"
           width="11.408922"
           height="11.408922"
           x="69.98597"
           y="43.39373" />
        <rect
           style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-8"
           width="11.408922"
           height="11.408922"
           x="81.404694"
           y="43.432133" />
        <rect
           style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-7-0"
           width="11.408922"
           height="11.408922"
           x="92.791351"
           y="43.432133" />
      </g>
      <path
         style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot);marker-end:url(#ArrowWide)"
         d="M 60.158153,17.58757 31.79239,42.570257"
         id="path1"
         sodipodi:nodetypes="cc" />
      <path
         style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot);marker-end:url(#ArrowWide)"
         d="m 71.941513,17.492227 7.02638,25.50316"
         id="path2"
         sodipodi:nodetypes="cc" />
      <path
         style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-0);marker-end:url(#ArrowWide-2)"
         d="m 83.690096,17.604011 54.134184,25.50316"
         id="path2-6"
         sodipodi:nodetypes="cc" />
      <path
         style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-3);marker-end:url(#ArrowWide-9)"
         d="M 94.931894,17.477191 199.85418,42.980351"
         id="path2-1"
         sodipodi:nodetypes="cc" />
      <g
         id="g6"
         transform="translate(-0.13339113,0.04489162)">
        <rect
           style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-2-1-1"
           width="11.408922"
           height="11.408922"
           x="121.22067"
           y="43.628765" />
        <rect
           style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-7-2-1-3"
           width="11.408922"
           height="11.408922"
           x="132.60733"
           y="43.628765" />
        <rect
           style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-0-0-9-8"
           width="11.408922"
           height="11.408922"
           x="143.99397"
           y="43.628765" />
        <rect
           style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-6-5-0-0"
           width="11.408922"
           height="11.408922"
           x="155.38062"
           y="43.628765" />
        <text
           xml:space="preserve"
           style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
           x="126.81036"
           y="52.536076"
           id="text1-5-97"><tspan
             sodipodi:role="line"
             id="tspan1-67-9"
             style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
             x="126.81036"
             y="52.536076">3</tspan></text>
        <text
           xml:space="preserve"
           style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
           x="138.77435"
           y="52.543888"
           id="text1-5-3-9"><tspan
             sodipodi:role="line"
             id="tspan1-67-8-3"
             style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
             x="138.77435"
             y="52.543888">4</tspan></text>
        <g
           id="g1-3-2"
           transform="translate(79.191051,0.07794914)">
          <text
             xml:space="preserve"
             style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
             x="70.097656"
             y="52.357845"
             id="text1-5-7-4"><tspan
               sodipodi:role="line"
               id="tspan1-67-87-3"
               style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
               x="70.097656"
               y="52.357845">-4</tspan></text>
        </g>
        <g
           id="g1-0-7"
           transform="translate(90.927766,0.00839714)">
          <text
             xml:space="preserve"
             style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
             x="70.097656"
             y="52.357845"
             id="text1-5-9-1"><tspan
               sodipodi:role="line"
               id="tspan1-67-88-2"
               style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
               x="70.097656"
               y="52.357845">2</tspan></text>
        </g>
      </g>
      <g
         id="g6-7"
         transform="translate(56.947448,0.04489162)">
        <rect
           style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-2-1-1-5"
           width="11.408922"
           height="11.408922"
           x="121.22067"
           y="43.628765" />
        <rect
           style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-7-2-1-3-1"
           width="11.408922"
           height="11.408922"
           x="132.60733"
           y="43.628765" />
        <rect
           style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-0-0-9-8-7"
           width="11.408922"
           height="11.408922"
           x="143.99397"
           y="43.628765" />
        <rect
           style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-6-5-0-0-4"
           width="11.408922"
           height="11.408922"
           x="155.38062"
           y="43.628765" />
        <text
           xml:space="preserve"
           style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
           x="126.81036"
           y="52.536076"
           id="text1-5-97-1"><tspan
             sodipodi:role="line"
             id="tspan1-67-9-7"
             style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
             x="126.81036"
             y="52.536076">5</tspan></text>
        <text
           xml:space="preserve"
           style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
           x="138.77435"
           y="52.543888"
           id="text1-5-3-9-1"><tspan
             sodipodi:role="line"
             id="tspan1-67-8-3-1"
             style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
             x="138.77435"
             y="52.543888">-1</tspan></text>
        <g
           id="g1-3-2-1"
           transform="translate(79.191051,0.07794914)">
          <text
             xml:space="preserve"
             style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
             x="70.097656"
             y="52.357845"
             id="text1-5-7-4-7"><tspan
               sodipodi:role="line"
               id="tspan1-67-87-3-0"
               style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
               x="70.097656"
               y="52.357845">3</tspan></text>
        </g>
        <g
           id="g1-0-7-4"
           transform="translate(90.927766,0.00839714)">
          <text
             xml:space="preserve"
             style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
             x="70.097656"
             y="52.357845"
             id="text1-5-9-1-0"><tspan
               sodipodi:role="line"
               id="tspan1-67-88-2-8"
               style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
               x="70.097656"
               y="52.357845">2</tspan></text>
        </g>
      </g>
      <g
         id="g6-7-2"
         transform="translate(123.96724,-0.81144458)"
         class="fragment">
        <g
           id="g9"
           transform="translate(2.3421269,0.91082714)">
          <rect
             style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-2-1-1-5-2"
             width="11.408922"
             height="11.408922"
             x="121.22067"
             y="43.628765" />
          <rect
             style="fill:#478640;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-7-2-1-3-1-2"
             width="11.408922"
             height="11.408922"
             x="132.60733"
             y="43.628765" />
          <rect
             style="fill:#478640;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-0-0-9-8-7-7"
             width="11.408922"
             height="11.408922"
             x="143.99397"
             y="43.628765" />
          <rect
             style="fill:#478640;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-6-5-0-0-4-0"
             width="11.408922"
             height="11.408922"
             x="155.38062"
             y="43.628765" />
          <text
             xml:space="preserve"
             style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
             x="126.81036"
             y="52.536076"
             id="text1-5-97-1-3"><tspan
               sodipodi:role="line"
               id="tspan1-67-9-7-4"
               style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
               x="126.81036"
               y="52.536076">7</tspan></text>
        </g>
      </g>
      <g
         id="g10"
         class="fragment">
        <g
           id="g2-8-1"
           transform="translate(196.84374,-30.794664)">
          <rect
             style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-5"
             width="11.408922"
             height="11.408922"
             x="58.599323"
             y="43.39373" />
          <rect
             style="fill:#478640;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-7-5"
             width="11.408922"
             height="11.408922"
             x="69.98597"
             y="43.39373" />
          <rect
             style="fill:#478640;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-8-4"
             width="11.408922"
             height="11.408922"
             x="81.404694"
             y="43.432133" />
          <rect
             style="fill:#478640;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-7-0-9"
             width="11.408922"
             height="11.408922"
             x="92.791351"
             y="43.432133" />
        </g>
        <path
           style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-2);marker-end:url(#ArrowWide-8)"
           d="m 261.61124,18.145666 -1.49959,24.246631"
           id="path1-7"
           sodipodi:nodetypes="cc" />
      </g>
      <g
         id="g11"
         class="fragment">
        <g
           id="g2-5"
           transform="translate(110.37071,-85.479825)">
          <rect
             style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-3"
             width="11.408922"
             height="11.408922"
             x="58.599323"
             y="43.39373" />
          <rect
             style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-7-9"
             width="11.408922"
             height="11.408922"
             x="69.98597"
             y="43.39373" />
          <rect
             style="fill:#478640;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-0"
             width="11.408922"
             height="11.408922"
             x="81.372612"
             y="43.39373" />
          <rect
             style="fill:#478640;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
             id="rect1-6"
             width="11.408922"
             height="11.408922"
             x="92.759254"
             y="43.39373" />
        </g>
        <path
           style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-2-7);marker-end:url(#ArrowWide-8-3)"
           d="M 174.94308,-35.771678 82.540144,11.292797"
           id="path1-7-5"
           sodipodi:nodetypes="cc" />
        <path
           style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-2-7-8);marker-end:url(#ArrowWide-8-3-6)"
           d="M 185.49908,-35.699915 266.43816,11.36456"
           id="path1-7-5-0"
           sodipodi:nodetypes="cc" />
      </g>
    </g>
  </g>
</svg>
</p>
<ul>
<li>Con tres niveles, pueden almacenarse ≤ 64 elementos.</li>
</ul>
</section>
<section class="slide level2">

<div>
<ul>
<li class="fragment"><p>Para acceder al elemento <code>i</code>-ésimo,
obtenemos una representación de bits del índice <code>i</code> y
formamos paquetes de <span class="math inline">log  <em>K</em></span>
bits.</p></li>
<li class="fragment"><p>Por ejemplo: posición <code>i = 17</code>.</p>
<p><svg
   width="74.763672mm"
   height="19.68959mm"
   viewBox="0 0 74.763672 19.68959"
   version="1.1"
   id="svg1"
   inkscape:version="1.4 (e7c3feb100, 2024-10-09)"
   sodipodi:docname="Numeros.svg"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <sodipodi:namedview
     id="namedview1"
     pagecolor="#ffffff"
     bordercolor="#000000"
     borderopacity="0.25"
     inkscape:showpageshadow="2"
     inkscape:pageopacity="0.0"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#d1d1d1"
     inkscape:document-units="mm"
     inkscape:zoom="1.4378367"
     inkscape:cx="323.05477"
     inkscape:cy="74.069608"
     inkscape:window-width="1920"
     inkscape:window-height="1011"
     inkscape:window-x="0"
     inkscape:window-y="0"
     inkscape:window-maximized="1"
     inkscape:current-layer="layer1" />
  <defs
     id="defs1" />
  <g
     inkscape:label="Capa 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(-5.8229415,-23.357913)">
    <text
       xml:space="preserve"
       style="font-size:7.7611px;font-family:monospace;-inkscape-font-specification:monospace;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#deffda;stroke:#2cf500;stroke-width:0.389001"
       x="42.323418"
       y="31.650557"
       id="text1"><tspan
         sodipodi:role="line"
         id="tspan1"
         style="fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
         x="42.323418"
         y="31.650557">17 = 0 1 0 0 0 1</tspan></text>
    <g
       id="g1"
       class="fragment">
      <rect
         style="fill:none;fill-opacity:1;stroke:#2cf500;stroke-width:0.389001;stroke-opacity:1"
         id="rect1"
         width="16.009293"
         height="10.12082"
         x="27.2342"
         y="23.553904" />
      <rect
         style="fill:none;fill-opacity:1;stroke:#0074f5;stroke-width:0.389001;stroke-opacity:1"
         id="rect1-0"
         width="16.009293"
         height="10.12082"
         x="45.770477"
         y="23.576284" />
      <rect
         style="fill:none;fill-opacity:1;stroke:#f5000f;stroke-width:0.389001;stroke-opacity:1"
         id="rect1-0-6"
         width="16.009293"
         height="10.12082"
         x="64.38282"
         y="23.552414" />
    </g>
    <g
       id="g2"
       class="fragment">
      <text
         xml:space="preserve"
         style="font-size:7.7611px;font-family:monospace;-inkscape-font-specification:monospace;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:none;fill-opacity:1;stroke:#f5000f;stroke-width:0.389001;stroke-opacity:1"
         x="35.26532"
         y="43.047504"
         id="text2"><tspan
           sodipodi:role="line"
           id="tspan2"
           style="fill:#11aa00;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="35.26532"
           y="43.047504">1</tspan></text>
      <text
         xml:space="preserve"
         style="font-size:7.7611px;font-family:monospace;-inkscape-font-specification:monospace;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:none;fill-opacity:1;stroke:#f5000f;stroke-width:0.389001;stroke-opacity:1"
         x="53.688278"
         y="42.775055"
         id="text2-7"><tspan
           sodipodi:role="line"
           id="tspan2-6"
           style="fill:#0063aa;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="53.688278"
           y="42.775055">0</tspan></text>
      <text
         xml:space="preserve"
         style="font-size:7.7611px;font-family:monospace;-inkscape-font-specification:monospace;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:none;fill-opacity:1;stroke:#f5000f;stroke-width:0.389001;stroke-opacity:1"
         x="71.827179"
         y="42.486599"
         id="text2-7-5"><tspan
           sodipodi:role="line"
           id="tspan2-6-0"
           style="fill:#aa0e00;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="71.827179"
           y="42.486599">1</tspan></text>
    </g>
  </g>
</svg>
</p></li>
<li class="fragment"><p>La secuencia de paquetes nos indica el camino
que debemos seguir desde el vector «raíz» hasta el elemento
correspondiente.</p></li>
</ul>
</div>
</section>
<section class="slide level2">

<p><img data-src="17/VTrie6.svg" /></p>
</section>
<section class="slide level2">

<h3 id="coste-de-las-operaciones-1">Coste de las operaciones</h3>
<p><span class="math inline"><em>n</em></span> = tamaño de la lista</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>Coste</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Añadir por el final</td>
<td><span
class="math inline"><em>O</em>(<em>l</em><em>o</em><em>g</em><sub><em>K</em></sub> <em>n</em>)</span></td>
</tr>
<tr class="even">
<td>Añadir por el principio</td>
<td><span class="math inline"><em>O</em>(<em>n</em>)</span></td>
</tr>
<tr class="odd">
<td>Modificar el valor <code>i</code>-ésimo</td>
<td><span
class="math inline"><em>O</em>(<em>l</em><em>o</em><em>g</em><sub><em>K</em></sub> <em>n</em>)</span></td>
</tr>
<tr class="even">
<td>Acceder a elemento <code>i</code>-ésimo</td>
<td><span
class="math inline"><em>O</em>(<em>l</em><em>o</em><em>g</em><sub><em>K</em></sub> <em>n</em>)</span></td>
</tr>
</tbody>
</table>
<div class="fragment">
<p>Con 1 billón de elementos (casi 4 TB de memoria) y <span
class="math inline"><em>K</em> = 32</span>, el árbol tendría profundidad
8.</p>
<p><span class="fragment rojo">Los costes <span
class="math inline"><em>O</em>(<em>l</em><em>o</em><em>g</em><sub><em>K</em></sub> <em>n</em>)</span>
son <span class="math inline"><em>O</em>(1)</span> en la
práctica</span></p>
</div>
</section>
<section id="árboles-binarios-de-búsqueda" class="slide level2">
<h2>Árboles binarios de búsqueda</h2>
<ul>
<li><p>Son útiles para implementar conjuntos y diccionarios.</p></li>
<li><p>Pueden implementarse mediante tipos unión:</p></li>
</ul>
<div class="sourceCode" id="cb63"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">sealed</span> <span class="kw">interface</span> ISet <span class="kw">permits</span> Empty<span class="op">,</span> <span class="bu">Node</span> <span class="op">{</span> <span class="co">/*...*/</span> <span class="op">}</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="kw">record</span> <span class="fu">Empty</span><span class="op">()</span> <span class="kw">implements</span> ISet <span class="op">{</span> <span class="op">}</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="kw">record</span> <span class="bu">Node</span><span class="op">(</span><span class="dt">int</span> elem<span class="op">,</span> ISet left<span class="op">,</span> ISet right<span class="op">)</span> <span class="kw">implements</span> ISet <span class="op">{</span> <span class="op">}</span></span></code></pre></div>

<div class="fragment">
<p><img data-src="17/ABB2.svg" /></p>
</div>
</section>
<section id="section-5" class="slide level2 ext"
data-background-image="img/Extension.jpg">
<h2 class="ext" data-background-image="img/Extension.jpg"></h2>
<ul>
<li>Por simplicidad, consideramos árboles de valores enteros.
<ul>
<li>Si se quisieran árboles de un tipo genérico <code>T</code>, ese tipo
tendría que implementar la interfaz
<code>Comparable&lt;T&gt;</code>.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb64"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="kw">public</span> <span class="kw">sealed</span> <span class="kw">interface</span> ISet<span class="op">&lt;</span>T <span class="kw">extends</span> <span class="bu">Comparable</span><span class="op">&lt;</span>T<span class="op">&gt;&gt;</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>          <span class="kw">permits</span> Empty<span class="op">,</span> <span class="bu">Node</span> <span class="op">{</span> <span class="co">/*...*/</span> <span class="op">}</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="kw">record</span> Empty<span class="op">&lt;</span>T <span class="kw">extends</span> <span class="bu">Comparable</span><span class="op">&lt;</span>T<span class="op">&gt;&gt;()</span> <span class="kw">implements</span> ISet<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="op">{</span> <span class="op">}</span>                                </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="kw">record</span> <span class="bu">Node</span><span class="op">&lt;</span>T <span class="kw">extends</span> <span class="bu">Comparable</span><span class="op">&lt;</span>T<span class="op">&gt;&gt;(</span>T elem<span class="op">,</span> </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>                                     ISet<span class="op">&lt;</span>T<span class="op">&gt;</span> left<span class="op">,</span> </span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>                                     ISet<span class="op">&lt;</span>T<span class="op">&gt;</span> right<span class="op">)</span> <span class="kw">implements</span> ISet<span class="op">&lt;</span>T<span class="op">&gt;</span> <span class="op">{</span> <span class="op">}</span></span></code></pre></div>

</section>
<section class="slide level2">

<h3 id="búsqueda-de-un-elemento-en-un-conjunto">Búsqueda de un elemento
en un conjunto</h3>
<ul>
<li>Si el conjunto no es vacío, comparamos el elemento a buscar con la
raíz.
<ul>
<li>Si el elemento a buscar es menor que la raíz, buscamos en el hijo
izquierdo.</li>
<li>Si es mayor que la raíz, buscamos en el hijo derecho.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb65"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="kw">default</span> <span class="dt">boolean</span> <span class="fu">contains</span><span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="cf">switch</span> <span class="op">(</span><span class="kw">this</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Empty _ <span class="op">-&gt;</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Node</span> v when x <span class="op">==</span> v<span class="op">.</span><span class="fu">elem</span><span class="op">()</span> <span class="op">-&gt;</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Node</span> v when x <span class="op">&lt;</span> v<span class="op">.</span><span class="fu">elem</span><span class="op">()</span> <span class="op">-&gt;</span> v<span class="op">.</span><span class="fu">left</span><span class="op">().</span><span class="fu">contains</span><span class="op">(</span>x<span class="op">);</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Node</span> v <span class="op">-&gt;</span> v<span class="op">.</span><span class="fu">right</span><span class="op">().</span><span class="fu">contains</span><span class="op">(</span>x<span class="op">);</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

</section>
<section class="slide level2">

<h3 id="inserción-de-un-elemento-en-un-conjunto">Inserción de un
elemento en un conjunto</h3>
<ul>
<li>Mecanismo similar a la búsqueda, pero cuando llegamos a un árbol
vacío, colocamos un nodo con el elemento a insertar.</li>
</ul>
<div class="sourceCode" id="cb66"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="kw">default</span> ISet <span class="fu">add</span><span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="cf">switch</span> <span class="op">(</span><span class="kw">this</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Empty _ <span class="op">-&gt;</span> <span class="hl"> <span class="kw">new</span> <span class="bu">Node</span><span class="op">(</span>x<span class="op">,</span> <span class="kw">new</span> <span class="fu">Empty</span><span class="op">(),</span> <span class="kw">new</span> <span class="fu">Empty</span><span class="op">())</span></span><span class="op">;</span>  <span class="arrow_box_left"> Nuevo nodo </span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Node</span> v when v<span class="op">.</span><span class="fu">elem</span><span class="op">()</span> <span class="op">==</span> x <span class="op">-&gt;</span> <span class="kw">this</span><span class="op">;</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Node</span> v when x <span class="op">&lt;</span> v<span class="op">.</span><span class="fu">elem</span><span class="op">()</span> <span class="op">-&gt;</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>      <span class="kw">new</span> <span class="bu">Node</span><span class="op">(</span>v<span class="op">.</span><span class="fu">elem</span><span class="op">(),</span> v<span class="op">.</span><span class="fu">left</span><span class="op">().</span><span class="fu">add</span><span class="op">(</span>x<span class="op">),</span> v<span class="op">.</span><span class="fu">right</span><span class="op">());</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Node</span> v <span class="op">-&gt;</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>      <span class="kw">new</span> <span class="bu">Node</span><span class="op">(</span>v<span class="op">.</span><span class="fu">elem</span><span class="op">(),</span> v<span class="op">.</span><span class="fu">left</span><span class="op">(),</span> v<span class="op">.</span><span class="fu">right</span><span class="op">().</span><span class="fu">add</span><span class="op">(</span>x<span class="op">));</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

</section>
<section class="slide level2">

<ul>
<li>En una implementación imperativa tradicional, los nodos del árbol se
modificarían para acomodar el nuevo elemento.</li>
<li>Por ejemplo, si insertamos el <code>7</code> en el siguiente
árbol:</li>
</ul>
<p><svg
   width="132.56383mm"
   height="104.82083mm"
   viewBox="0 0 132.56383 104.82083"
   version="1.1"
   id="svg1"
   inkscape:version="1.4 (e7c3feb100, 2024-10-09)"
   sodipodi:docname="ABB3.svg"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:svg="http://www.w3.org/2000/svg">
  <sodipodi:namedview
     id="namedview1"
     pagecolor="#ffffff"
     bordercolor="#000000"
     borderopacity="0.25"
     inkscape:showpageshadow="2"
     inkscape:pageopacity="0.0"
     inkscape:pagecheckerboard="0"
     inkscape:deskcolor="#d1d1d1"
     inkscape:document-units="mm"
     inkscape:zoom="1.4378367"
     inkscape:cx="89.718116"
     inkscape:cy="252.11486"
     inkscape:window-width="1920"
     inkscape:window-height="1011"
     inkscape:window-x="0"
     inkscape:window-y="0"
     inkscape:window-maximized="1"
     inkscape:current-layer="layer1" />
  <defs
     id="defs1">
    <marker
       style="overflow:visible"
       id="Dot"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-9"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-7" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-7"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-6" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-6"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-3" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-9"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-4" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-6-3"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-3-9" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-9-0"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-4-8" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-6-6"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-3-3" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-9-8"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-4-5" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-6-3-4"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-3-9-4" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-9-0-4"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-4-8-4" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-6-3-6"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-3-9-0" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-9-0-48"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-4-8-8" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-6-3-64"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-3-9-3" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-9-0-0"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-4-8-3" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-6-3-0"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-3-9-5" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-9-0-9"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-4-8-46" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-6-3-7"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-3-9-7" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-9-0-5"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-4-8-48" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-6-3-68"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-3-9-02" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-9-0-1"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-4-8-0" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-6-3-68-8"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-3-9-02-5" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-9-0-1-0"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-4-8-0-6" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-6-3-68-86"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-3-9-02-2" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-9-0-1-8"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-4-8-0-4" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-6-3-68-6"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-3-9-02-29" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-9-0-1-9"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-4-8-0-0" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-6-3-64-5"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-3-9-3-7" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-9-0-0-1"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-4-8-3-6" />
    </marker>
    <marker
       style="overflow:visible"
       id="Dot-6-3-68-8-9"
       refX="0"
       refY="0"
       orient="auto"
       inkscape:stockid="Dot"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         transform="scale(0.5)"
         style="fill:context-stroke;fill-rule:evenodd;stroke:none"
         d="M 5,0 C 5,2.76 2.76,5 0,5 -2.76,5 -5,2.76 -5,0 c 0,-2.76 2.3,-5 5,-5 2.76,0 5,2.24 5,5 z"
         sodipodi:nodetypes="sssss"
         id="path17-3-9-02-5-8" />
    </marker>
    <marker
       style="overflow:visible"
       id="ArrowWide-9-0-1-0-1"
       refX="0"
       refY="0"
       orient="auto-start-reverse"
       inkscape:stockid="Wide arrow"
       markerWidth="1"
       markerHeight="1"
       viewBox="0 0 1 1"
       inkscape:isstock="true"
       inkscape:collect="always"
       preserveAspectRatio="xMidYMid">
      <path
         style="fill:none;stroke:context-stroke;stroke-width:1;stroke-linecap:butt"
         d="M 3,-3 0,0 3,3"
         transform="rotate(180,0.125,0)"
         sodipodi:nodetypes="ccc"
         id="path2-4-8-0-6-3" />
    </marker>
  </defs>
  <g
     inkscape:label="Capa 1"
     inkscape:groupmode="layer"
     id="layer1"
     transform="translate(-65.318226,-9.219123)">
    <g
       id="g2"
       transform="translate(80.545244,-5.8183173)">
      <rect
         style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1"
         width="11.408922"
         height="11.408922"
         x="40.299255"
         y="15.23194" />
      <rect
         style="fill:#5da955;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2"
         width="4.9684019"
         height="11.408922"
         x="51.696243"
         y="15.23194" />
      <rect
         style="fill:#5da955;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-7"
         width="4.9684019"
         height="11.408922"
         x="35.357693"
         y="15.23194" />
    </g>
    <g
       id="g2-7"
       transform="translate(55.667435,18.599952)">
      <rect
         style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-8"
         width="11.408922"
         height="11.408922"
         x="40.299255"
         y="15.23194" />
      <rect
         style="fill:#5da955;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-6"
         width="4.9684019"
         height="11.408922"
         x="51.696243"
         y="15.23194" />
      <rect
         style="fill:#5da955;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-7-8"
         width="4.9684019"
         height="11.408922"
         x="35.357693"
         y="15.23194" />
    </g>
    <g
       id="g2-1"
       transform="translate(102.66386,18.59347)">
      <rect
         style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-4"
         width="11.408922"
         height="11.408922"
         x="40.299255"
         y="15.23194" />
      <rect
         style="fill:#5da955;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-9"
         width="4.9684019"
         height="11.408922"
         x="51.696243"
         y="15.23194" />
      <rect
         style="fill:#5da955;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-7-2"
         width="4.9684019"
         height="11.408922"
         x="35.357693"
         y="15.23194" />
    </g>
    <g
       id="g2-9"
       transform="translate(36.732816,43.784593)">
      <rect
         style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-26"
         width="11.408922"
         height="11.408922"
         x="40.299255"
         y="15.23194" />
      <rect
         style="fill:#5da955;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-64"
         width="4.9684019"
         height="11.408922"
         x="51.696243"
         y="15.23194" />
      <rect
         style="fill:#5da955;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-7-9"
         width="4.9684019"
         height="11.408922"
         x="35.357693"
         y="15.23194" />
    </g>
    <g
       id="g2-8"
       transform="translate(121.90085,43.452367)">
      <rect
         style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-7"
         width="11.408922"
         height="11.408922"
         x="40.299255"
         y="15.23194" />
      <rect
         style="fill:#5da955;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-1"
         width="4.9684019"
         height="11.408922"
         x="51.696243"
         y="15.23194" />
      <rect
         style="fill:#5da955;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-7-7"
         width="4.9684019"
         height="11.408922"
         x="35.357693"
         y="15.23194" />
    </g>
    <g
       id="g2-2"
       transform="translate(88.945257,43.453358)">
      <rect
         style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-6"
         width="11.408922"
         height="11.408922"
         x="40.299255"
         y="15.23194" />
      <rect
         style="fill:#5da955;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-10"
         width="4.9684019"
         height="11.408922"
         x="51.696243"
         y="15.23194" />
      <rect
         style="fill:#5da955;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-7-6"
         width="4.9684019"
         height="11.408922"
         x="35.357693"
         y="15.23194" />
    </g>
    <g
       id="g2-4"
       transform="translate(136.11175,70.043012)">
      <rect
         style="fill:#deffda;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-9"
         width="11.408922"
         height="11.408922"
         x="40.299255"
         y="15.23194" />
      <rect
         style="fill:#5da955;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-0"
         width="4.9684019"
         height="11.408922"
         x="51.696243"
         y="15.23194" />
      <rect
         style="fill:#5da955;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-7-91"
         width="4.9684019"
         height="11.408922"
         x="35.357693"
         y="15.23194" />
    </g>
    <path
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot);marker-end:url(#ArrowWide)"
       d="m 134.86559,15.058826 13.36135,18.217472"
       id="path1"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-9);marker-end:url(#ArrowWide-7)"
       d="m 118.26536,15.238326 -15.713,17.849442"
       id="path1-3"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-6);marker-end:url(#ArrowWide-9)"
       d="m 157.03778,39.788907 13.36135,18.217472"
       id="path1-1"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-6-3);marker-end:url(#ArrowWide-9-0)"
       d="m 140.50328,39.914202 -7.43233,17.849442"
       id="path1-1-5"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-6-6);marker-end:url(#ArrowWide-9-8)"
       d="m 175.88787,64.907395 7.65689,20.057621"
       id="path1-1-1"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-6-3-4);marker-end:url(#ArrowWide-9-0-4)"
       d="M 93.418335,39.843548 81.753663,58.429049"
       id="path1-1-5-6"
       sodipodi:nodetypes="cc" />
    <rect
       style="fill:#55a957;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
       id="rect1-2-7-5"
       width="4.6923804"
       height="4.5083647"
       x="112.5668"
       y="57.456867" />
    <rect
       style="fill:#55a957;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
       id="rect1-2-7-5-1"
       width="4.6923804"
       height="4.5083647"
       x="119.73942"
       y="83.619812" />
    <rect
       style="fill:#55a957;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
       id="rect1-2-7-5-7"
       width="4.6923804"
       height="4.5083647"
       x="143.60664"
       y="83.619812" />
    <rect
       style="fill:#55a957;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
       id="rect1-2-7-5-5"
       width="4.6923804"
       height="4.5083647"
       x="65.512726"
       y="83.619812" />
    <rect
       style="fill:#55a957;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
       id="rect1-2-7-5-3"
       width="4.6923804"
       height="4.5083647"
       x="92.211815"
       y="83.619812" />
    <rect
       style="fill:#55a957;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
       id="rect1-2-7-5-18"
       width="4.6923804"
       height="4.5083647"
       x="166.49506"
       y="109.33709" />
    <rect
       style="fill:#55a957;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
       id="rect1-2-7-5-33"
       width="4.6923804"
       height="4.5083647"
       x="192.99518"
       y="109.33709" />
    <rect
       style="fill:#55a957;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
       id="rect1-2-7-5-18-0"
       width="4.6923804"
       height="4.5083647"
       x="152.34482"
       y="83.788872" />
    <path
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-6-3-6);marker-end:url(#ArrowWide-9-0-48)"
       d="m 74.785098,65.062546 -7.43233,17.849442"
       id="path1-1-5-9"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-6-3-64);marker-end:url(#ArrowWide-9-0-0)"
       d="m 126.81464,65.033647 -4.85612,18.585499"
       id="path1-1-5-92"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-6-3-0);marker-end:url(#ArrowWide-9-0-9)"
       d="M 159.92435,65.06945 154.7002,82.91889"
       id="path1-1-5-2"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-6-3-7);marker-end:url(#ArrowWide-9-0-5)"
       d="m 173.99698,91.442255 -5.96021,16.929375"
       id="path1-1-5-28"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-6-3-68);marker-end:url(#ArrowWide-9-0-1)"
       d="m 190.52846,90.880255 4.52864,17.665435"
       id="path1-1-5-1"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-6-3-68-8);marker-end:url(#ArrowWide-9-0-1-0)"
       d="m 143.1126,64.669777 3.24053,18.769519"
       id="path1-1-5-1-6"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-6-3-68-86);marker-end:url(#ArrowWide-9-0-1-8)"
       d="m 109.75623,39.503513 5.08068,17.66543"
       id="path1-1-5-1-2"
       sodipodi:nodetypes="cc" />
    <path
       style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-6-3-68-6);marker-end:url(#ArrowWide-9-0-1-9)"
       d="m 90.927043,64.97813 4.344621,18.769519"
       id="path1-1-5-1-1"
       sodipodi:nodetypes="cc" />
    <text
       xml:space="preserve"
       style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
       x="126.52518"
       y="18.240381"
       id="text1"><tspan
         sodipodi:role="line"
         id="tspan1"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
         x="126.52518"
         y="18.240381">14</tspan></text>
    <text
       xml:space="preserve"
       style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
       x="101.70705"
       y="42.579071"
       id="text1-3"><tspan
         sodipodi:role="line"
         id="tspan1-3"
         style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
         x="101.70705"
         y="42.579071">9</tspan></text>
    <g
       id="g1"
       transform="translate(36.33912,43.369944)">
      <text
         xml:space="preserve"
         style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
         x="46.452187"
         y="23.941742"
         id="text1-6"><tspan
           sodipodi:role="line"
           id="tspan1-6"
           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="46.452187"
           y="23.941742">3</tspan></text>
    </g>
    <g
       id="g2-6"
       transform="translate(88.690641,43.107344)">
      <text
         xml:space="preserve"
         style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
         x="46.452187"
         y="23.941742"
         id="text1-6-2"><tspan
           sodipodi:role="line"
           id="tspan1-6-6"
           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="46.452187"
           y="23.941742">15</tspan></text>
    </g>
    <g
       id="g2-87"
       transform="translate(102.27888,18.207684)">
      <text
         xml:space="preserve"
         style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
         x="46.452187"
         y="23.941742"
         id="text1-6-28"><tspan
           sodipodi:role="line"
           id="tspan1-6-2"
           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="46.452187"
           y="23.941742">19</tspan></text>
    </g>
    <g
       id="g2-27"
       transform="translate(121.78545,43.144144)">
      <text
         xml:space="preserve"
         style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
         x="46.452187"
         y="23.941742"
         id="text1-6-6"><tspan
           sodipodi:role="line"
           id="tspan1-6-1"
           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="46.452187"
           y="23.941742">21</tspan></text>
    </g>
    <g
       id="g2-99"
       transform="translate(135.54175,69.634388)">
      <text
         xml:space="preserve"
         style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
         x="46.452187"
         y="23.941742"
         id="text1-6-1"><tspan
           sodipodi:role="line"
           id="tspan1-6-4"
           style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
           x="46.452187"
           y="23.941742">25</tspan></text>
    </g>
    <g
       id="g3"
       class="fragment">
      <g
         id="g2-9-2"
         transform="translate(49.784911,68.344552)">
        <rect
           style="fill:#fff3da;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-26-3"
           width="11.408922"
           height="11.408922"
           x="40.299255"
           y="15.23194" />
        <rect
           style="fill:#a98855;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-2-64-1"
           width="4.9684019"
           height="11.408922"
           x="51.696243"
           y="15.23194" />
        <rect
           style="fill:#a98955;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
           id="rect1-2-7-9-8"
           width="4.9684019"
           height="11.408922"
           x="35.357693"
           y="15.23194" />
      </g>
      <g
         id="g2-3"
         transform="translate(49.391215,67.929902)">
        <text
           xml:space="preserve"
           style="font-size:7.76111px;font-family:Raleway;-inkscape-font-specification:Raleway;text-align:center;writing-mode:lr-tb;direction:ltr;text-anchor:middle;fill:#5596a9;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1"
           x="46.452187"
           y="23.941742"
           id="text1-6-4"><tspan
             sodipodi:role="line"
             id="tspan1-6-22"
             style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:7.76111px;font-family:monospace;-inkscape-font-specification:monospace;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.389"
             x="46.452187"
             y="23.941742">7</tspan></text>
      </g>
      <rect
         style="fill:#a98355;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-7-5-1-7"
         width="4.6923804"
         height="4.5083647"
         x="80.271652"
         y="109.05158" />
      <rect
         style="fill:#a98355;fill-opacity:1;stroke:#000000;stroke-width:0.389;stroke-dasharray:none;stroke-opacity:1"
         id="rect1-2-7-5-7-9"
         width="4.6923804"
         height="4.5083647"
         x="104.13889"
         y="109.05158" />
      <path
         style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-6-3-64-5);marker-end:url(#ArrowWide-9-0-0-1)"
         d="m 87.346884,90.465408 -4.85612,18.585502"
         id="path1-1-5-92-8"
         sodipodi:nodetypes="cc" />
      <path
         style="fill:none;fill-opacity:1;stroke:#000000;stroke-width:0.389001;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot-6-3-68-8-9);marker-end:url(#ArrowWide-9-0-1-0-1)"
         d="m 103.64484,90.101538 3.24053,18.769522"
         id="path1-1-5-1-6-6"
         sodipodi:nodetypes="cc" />
    </g>
  </g>
</svg>
</p>
</section>
<section class="slide level2">

<ul>
<li>En la implementación funcional, se crea un nuevo árbol que
<strong>comparte</strong> algunos hijos con el árbol original.</li>
</ul>
<p><img data-src="17/ABB4.svg" /></p>
</section>
<section class="slide level2">

<p><img data-src="17/ABB4.svg" style="width:70.0%" /></p>
<ul>
<li>Solamente se reconstruyen los nodos que están entre la raíz y el
nodo recién insertado.</li>
<li>El resto de nodos se reutilizan en el resultado.
<ul>
<li>Coste en memoria: <span
class="math inline"><em>O</em>(log  <em>n</em>)</span>, con <span
class="math inline"><em>n</em></span> el tamaño del árbol si está
equilibrado.</li>
</ul></li>
</ul>
</section>
<section class="slide level2">

<h3 id="eliminación-de-un-elemento-de-un-conjunto">Eliminación de un
elemento de un conjunto</h3>
<ul>
<li><p>Necesitamos un método auxiliar <code>removeLowest</code>, que
devuelve el resultado de eliminar el nodo <strong>con menor
valor</strong> en un árbol binario de búsqueda.</p></li>
<li><p>Devuelve:</p>
<ul>
<li>El valor del nodo eliminado.</li>
<li>El árbol resultante tras eliminar ese nodo.</li>
</ul></li>
<li><p>Definimos el valor de retorno de <code>removeLowest</code>
mediante un tipo <code>record</code>:</p>
<div class="sourceCode" id="cb67"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="kw">record</span> <span class="fu">RemoveLowestResult</span><span class="op">(</span><span class="dt">int</span> lowest<span class="op">,</span> ISet result<span class="op">)</span> <span class="op">{</span> <span class="op">}</span></span></code></pre></div>
</li>
</ul>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb68"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span> RemoveLowestResult <span class="fu">removeLowest</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="cf">switch</span> <span class="op">(</span><span class="kw">this</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Empty _ <span class="op">-&gt;</span> </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>      <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">RuntimeException</span><span class="op">(</span><span class="st">&quot;RemoveLowest en árbol vacío&quot;</span><span class="op">);</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Node</span><span class="op">(</span><span class="dt">var</span> elem<span class="op">,</span> <span class="fu">Empty</span><span class="op">(),</span> <span class="dt">var</span> r<span class="op">)</span> <span class="op">-&gt;</span> </span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>      <span class="kw">new</span> <span class="fu">RemoveLowestResult</span><span class="op">(</span>elem<span class="op">,</span> r<span class="op">);</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Node</span><span class="op">(</span><span class="dt">var</span> elem<span class="op">,</span> <span class="dt">var</span> l<span class="op">,</span> <span class="dt">var</span> r<span class="op">)</span> <span class="op">-&gt;</span> <span class="op">{</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>      <span class="dt">var</span> leftResult <span class="op">=</span> l<span class="op">.</span><span class="fu">removeLowest</span><span class="op">();</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a>      <span class="cf">yield</span> <span class="kw">new</span> <span class="fu">RemoveLowestResult</span><span class="op">(</span>leftResult<span class="op">.</span><span class="fu">lowest</span><span class="op">(),</span> </span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a>                                   <span class="kw">new</span> <span class="bu">Node</span><span class="op">(</span>elem<span class="op">,</span> leftResult<span class="op">.</span><span class="fu">result</span><span class="op">(),</span> r<span class="op">));</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

</section>
<section class="slide level2">

<ul>
<li>Para borrar un elemento de un conjunto, lo buscamos en el árbol
binario de búsqueda.</li>
<li>Cuando lo encontramos, construimos un árbol sin ese elemento.
<ul>
<li>Si el nodo correspondiente tenía un hijo vacío, se coloca el otro en
su lugar.</li>
<li>Si el nodo correspondiente no tenía hijos vacíos, se construye un
nodo con el elemento menor del hijo derecho, que será eliminado de este
último.</li>
</ul></li>
</ul>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb69" style="font-size:80%"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="kw">default</span> ISet <span class="fu">remove</span><span class="op">(</span><span class="dt">int</span> x<span class="op">)</span> <span class="op">{</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="cf">switch</span> <span class="op">(</span><span class="kw">this</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Si el elemento a borrar no se encuentra en el árbol, devolvemos el</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// mismo árbol</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> Empty _ <span class="op">-&gt;</span> <span class="kw">this</span><span class="op">;</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Si el elemento a borrar se encuentra en el árbol, y su hijo derecho</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// está vacío, devolvemos el hijo izquierdo.</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Node</span> v when v<span class="op">.</span><span class="fu">elem</span><span class="op">()</span> <span class="op">==</span> x <span class="op">&amp;&amp;</span> v<span class="op">.</span><span class="fu">right</span><span class="op">().</span><span class="fu">isEmpty</span><span class="op">()</span> <span class="op">-&gt;</span> v<span class="op">.</span><span class="fu">left</span><span class="op">();</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Caso análogo al anterior.</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Node</span> v when v<span class="op">.</span><span class="fu">elem</span><span class="op">()</span> <span class="op">==</span> x <span class="op">&amp;&amp;</span> v<span class="op">.</span><span class="fu">left</span><span class="op">().</span><span class="fu">isEmpty</span><span class="op">()</span> <span class="op">-&gt;</span> v<span class="op">.</span><span class="fu">right</span><span class="op">();</span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Si el elemento a borrar tiene dos hijos no vacíos, eliminamos el</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">// menor valor del hijo derecho, que será la nueva raíz.</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Node</span> v when v<span class="op">.</span><span class="fu">elem</span><span class="op">()</span> <span class="op">==</span> x  <span class="op">-&gt;</span> <span class="op">{</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>      <span class="dt">var</span> rightResult <span class="op">=</span> v<span class="op">.</span><span class="fu">right</span><span class="op">().</span><span class="fu">removeLowest</span><span class="op">();</span></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>      <span class="cf">yield</span> <span class="kw">new</span> <span class="bu">Node</span><span class="op">(</span>rightResult<span class="op">.</span><span class="fu">lowest</span><span class="op">(),</span> v<span class="op">.</span><span class="fu">left</span><span class="op">(),</span> rightResult<span class="op">.</span><span class="fu">result</span><span class="op">());</span></span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ...continúa...</span></span></code></pre></div>

</section>
<section class="slide level2">

<div class="sourceCode" id="cb70" style="font-size:80%"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ...continuación...</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">// Si el elemento a borrar no es la raíz, buscamos en el hijo</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">// izquierdo o derecho, según corresponda.</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Node</span> v when x <span class="op">&lt;</span> v<span class="op">.</span><span class="fu">elem</span><span class="op">()</span> <span class="op">-&gt;</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>            <span class="kw">new</span> <span class="bu">Node</span><span class="op">(</span>v<span class="op">.</span><span class="fu">elem</span><span class="op">(),</span> v<span class="op">.</span><span class="fu">left</span><span class="op">().</span><span class="fu">remove</span><span class="op">(</span>x<span class="op">),</span> v<span class="op">.</span><span class="fu">right</span><span class="op">());</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">case</span> <span class="bu">Node</span> v <span class="op">-&gt;</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>            <span class="kw">new</span> <span class="bu">Node</span><span class="op">(</span>v<span class="op">.</span><span class="fu">elem</span><span class="op">(),</span> v<span class="op">.</span><span class="fu">left</span><span class="op">(),</span> v<span class="op">.</span><span class="fu">right</span><span class="op">().</span><span class="fu">remove</span><span class="op">(</span>x<span class="op">));</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="op">};</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>

</section>
<section class="slide level2">

<h3 id="árboles-equilibrados">Árboles equilibrados</h3>
<ul>
<li><p>La implementación mostrada anteriormente puede dar lugar a
árboles desequilibrados.</p>
<ul>
<li>En este caso, el coste de una operación podría ser
<strong>lineal</strong> con respecto al número de elementos del
conjunto.</li>
</ul></li>
<li><p>Existen implementaciones que reequilibran el árbol cada vez que
se realiza una operación de inserción o borrado.</p>
<ul>
<li><p>Árboles AVL <a
href="https://en.wikipedia.org/wiki/AVL_tree">[+]</a></p></li>
<li><p>Árboles rojinegros <a
href="https://en.wikipedia.org/wiki/Red%E2%80%93black_tree">[+]</a></p></li>
</ul></li>
</ul>
</section>
<section class="slide level2">

<h3 id="coste-de-las-operaciones-2">Coste de las operaciones</h3>
<p>Coste en espacio y tiempo, suponiendo árboles equilibrados</p>
<p><span class="math inline"><em>n</em></span> es el número de elementos
del conjunto.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th style="text-align: center;">Coste tiempo</th>
<th style="text-align: center;">Coste espacio</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Búsqueda</td>
<td style="text-align: center;"><span
class="math inline"><em>O</em>(<em>l</em><em>o</em><em>g</em> <em>n</em>)</span></td>
<td style="text-align: center;"><span
class="math inline"><em>O</em>(1)</span></td>
</tr>
<tr class="even">
<td>Inserción</td>
<td style="text-align: center;"><span
class="math inline"><em>O</em>(<em>l</em><em>o</em><em>g</em> <em>n</em>)</span></td>
<td style="text-align: center;"><span
class="math inline"><em>O</em>(<em>l</em><em>o</em><em>g</em> <em>n</em>)</span></td>
</tr>
<tr class="odd">
<td>Borrado</td>
<td style="text-align: center;"><span
class="math inline"><em>O</em>(<em>l</em><em>o</em><em>g</em> <em>n</em>)</span></td>
<td style="text-align: center;"><span
class="math inline"><em>O</em>(<em>l</em><em>o</em><em>g</em> <em>n</em>)</span></td>
</tr>
</tbody>
</table>
</section>
<section id="java-immutable-collections" class="slide level2">
<h2><code>java-immutable-collections</code></h2>
<p><a
href="http://brianburton.github.io/java-immutable-collections/">http://brianburton.github.io/java-immutable-collections/</a></p>
<ul>
<li><p>Es una biblioteca de Java que proporciona implementaciones de
estructuras persistentes.</p>
<ul>
<li><code>IDeque</code>: colas dobles</li>
<li><code>IList</code>: listas</li>
<li><code>IMap</code>: diccionarios</li>
<li><code>ISet</code>: conjuntos</li>
</ul></li>
</ul>
</section>
<section class="slide level2">

<h3 id="ideque"><code>IDeque</code></h3>
<ul>
<li>Implementa dobles colas utilizando árboles no equilibrados de aridad
32.</li>
<li>Solamente inserciones/borrados al principio y al final.</li>
<li>Las operaciones tienen coste <span
class="math inline"><em>O</em>(log<sub>32</sub> <em>n</em>)</span>,
donde <span class="math inline"><em>n</em></span> es el tamaño de la
cola doble.</li>
</ul>
<div class="sourceCode" id="cb71"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> d1 <span class="op">=</span> IDeques<span class="op">.</span><span class="fu">of</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">10</span><span class="op">);</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> d2 <span class="op">=</span> d1<span class="op">.</span><span class="fu">insert</span><span class="op">(</span><span class="dv">20</span><span class="op">).</span><span class="fu">insertFirst</span><span class="op">(-</span><span class="dv">3</span><span class="op">);</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// d1 = [1,5,10], d2 = [-3,1,5,10,20]</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> d3 <span class="op">=</span> d2<span class="op">.</span><span class="fu">deleteFirst</span><span class="op">().</span><span class="fu">deleteFirst</span><span class="op">().</span><span class="fu">deleteLast</span><span class="op">();</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">// d2 = [-3,1,5,10,20], d3 = [5,10]</span></span></code></pre></div>

</section>
<section class="slide level2">

<h3 id="ilist"><code>IList</code></h3>
<ul>
<li><p>Listas implementadas mediante árboles binarios
equilibrados.</p></li>
<li><p>Permiten inserciones/borrados al principio, al final y en
mitad.</p></li>
<li><p>Coste operaciones: <span
class="math inline"><em>O</em>(log  <em>n</em>)</span>, con <span
class="math inline"><em>n</em></span> el tamaño de la lista.</p></li>
</ul>
<div class="sourceCode" id="cb72"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> i1 <span class="op">=</span> ILists<span class="op">.</span><span class="fu">of</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">30</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">9</span><span class="op">);</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> i2 <span class="op">=</span> i1<span class="op">.</span><span class="fu">assign</span><span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">20</span><span class="op">);</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// i1 = [1,30,5,9], i2 = [1,20,5,9]</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> i3 <span class="op">=</span> i2<span class="op">.</span><span class="fu">delete</span><span class="op">(</span><span class="dv">2</span><span class="op">);</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">// i2 = [1,20,5,9], i3 = [1,20,9]</span></span></code></pre></div>

</section>
<section class="slide level2">

<h3 id="iset"><code>ISet</code></h3>
<ul>
<li><p>Conjuntos implementados mediante:</p>
<ul>
<li><p><em>Hashmapped array tries</em>, si se crean mediante
<code>ISets.hashed()</code></p>
<p>Coste de las operaciones: <span
class="math inline"><em>O</em>(log<sub>32</sub> <em>n</em>)</span>,
donde <span class="math inline"><em>n</em></span> es el tamaño del
conjunto.</p></li>
<li><p>Árboles binarios de búsqueda equilibrados, si se crean mediante
<code>ISets.sorted()</code></p>
<p>Coste de las operaciones: <span
class="math inline"><em>O</em>(log  <em>n</em>)</span>, donde <span
class="math inline"><em>n</em></span> es el tamaño del
conjunto.</p></li>
</ul></li>
</ul>
</section>
<section class="slide level2">

<div class="sourceCode" id="cb73"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> s1 <span class="op">=</span> ISets<span class="op">.</span><span class="fu">sorted</span><span class="op">(</span><span class="dv">10</span><span class="op">,</span> <span class="dv">5</span><span class="op">,</span> <span class="dv">3</span><span class="op">,</span> <span class="dv">20</span><span class="op">);</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> s2 <span class="op">=</span> s1<span class="op">.</span><span class="fu">insert</span><span class="op">(</span><span class="dv">4</span><span class="op">).</span><span class="fu">delete</span><span class="op">(</span><span class="dv">20</span><span class="op">);</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// s1 = {3,5,10,20}, s2 = {3,4,5,10}</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>s1<span class="op">.</span><span class="fu">contains</span><span class="op">(</span><span class="dv">20</span><span class="op">));</span>  <span class="co">// true</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>s2<span class="op">.</span><span class="fu">contains</span><span class="op">(</span><span class="dv">20</span><span class="op">));</span>  <span class="co">// false</span></span></code></pre></div>

</section>
<section class="slide level2">

<h3 id="imap"><code>IMap</code></h3>
<ul>
<li>Similar a <code>ISet</code>, pero para almacenar diccionarios en
lugar de conjuntos.</li>
</ul>
<div class="sourceCode" id="cb74"><pre
class="sourceCode java"><code class="sourceCode java"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="dt">var</span> d <span class="op">=</span> IMaps<span class="op">.</span><span class="fu">hashed</span><span class="op">().</span><span class="fu">assign</span><span class="op">(</span><span class="st">&quot;Pepe&quot;</span><span class="op">,</span> <span class="dv">32</span><span class="op">).</span><span class="fu">assign</span><span class="op">(</span><span class="st">&quot;Maria&quot;</span><span class="op">,</span> <span class="dv">25</span><span class="op">);</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>d<span class="op">.</span><span class="fu">get</span><span class="op">(</span><span class="st">&quot;Pepe&quot;</span><span class="op">));</span>                  <span class="co">// 32</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="bu">System</span><span class="op">.</span><span class="fu">out</span><span class="op">.</span><span class="fu">println</span><span class="op">(</span>d<span class="op">.</span><span class="fu">getValueOr</span><span class="op">(</span><span class="st">&quot;NoExiste&quot;</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span><span class="op">));</span>   <span class="co">// -1</span></span></code></pre></div>

</section></section>
    </div>
  </div>

  <script src="dist/reveal.js"></script>

  <!-- reveal.js plugins -->
  <script src="plugin/notes/notes.js"></script>
  <script src="plugin/search/search.js"></script>
  <script src="plugin/zoom/zoom.js"></script>
  <script src="plugin/highlight/highlight.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
        // Display controls in the bottom right corner
        controls: true,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: true,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'bottom-right',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: false,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: true,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'default',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Prints all fragments in their visible states on the same slide 
        pdfSeparateFragments: false,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: true,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'slide',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'fade',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // reveal.js plugins
        plugins: [
          RevealNotes,
          RevealSearch,
          RevealZoom,
          // RevealHighlight          
        ]
      });
    </script>
    </body>
</html>
